import{_ as h}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as r,p as c,c as u,w as t,o as p,a as e,b as l,d as i,r as _,e as g}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const m="/ML_NLP_phishing_email/1-frame.png",f="/ML_NLP_phishing_email/2-process.png",L="/ML_NLP_phishing_email/3-process2.png",N="/ML_NLP_phishing_email/4-calculate.png",v="/ML_NLP_phishing_email/5-scales.png",k="/ML_NLP_phishing_email/6-firstcalcu.png",b="/ML_NLP_phishing_email/7-otherlayer.png",P="/ML_NLP_phishing_email/8-3foldvalidation.png",M="/ML_NLP_phishing_email/9-confusionmatrix.png",C="/ML_NLP_phishing_email/10-othervalues.png",y="/ML_NLP_phishing_email/11-othervalues.png",dl=JSON.parse('{"title":"恶意URL检测(十)应用ML和NLP的方法去检测钓鱼邮件","description":"","frontmatter":{"categories":"恶意URL检测","date":"2021-08-19T10:41:37.000Z","layout":"post","tags":null,"title":"恶意URL检测(十)应用ML和NLP的方法去检测钓鱼邮件"},"headers":[{"level":2,"title":"1.背景","slug":"_1-背景","link":"#_1-背景","children":[{"level":3,"title":"1.1刊物/会议级别","slug":"_1-1刊物-会议级别","link":"#_1-1刊物-会议级别","children":[]},{"level":3,"title":"1.2作者团队","slug":"_1-2作者团队","link":"#_1-2作者团队","children":[]},{"level":3,"title":"1.3文章创新点","slug":"_1-3文章创新点","link":"#_1-3文章创新点","children":[]}]},{"level":2,"title":"2.相关工作进展","slug":"_2-相关工作进展","link":"#_2-相关工作进展","children":[{"level":3,"title":"2.1特征选择","slug":"_2-1特征选择","link":"#_2-1特征选择","children":[]},{"level":3,"title":"2.2分类算法","slug":"_2-2分类算法","link":"#_2-2分类算法","children":[]}]},{"level":2,"title":"3.本文方法","slug":"_3-本文方法","link":"#_3-本文方法","children":[{"level":3,"title":"3.1数据预处理","slug":"_3-1数据预处理","link":"#_3-1数据预处理","children":[]},{"level":3,"title":"3.2图构建","slug":"_3-2图构建","link":"#_3-2图构建","children":[]},{"level":3,"title":"3.3GCN分类器","slug":"_3-3gcn分类器","link":"#_3-3gcn分类器","children":[]}]},{"level":2,"title":"4.实验结果及评估","slug":"_4-实验结果及评估","link":"#_4-实验结果及评估","children":[{"level":3,"title":"4.1数据集","slug":"_4-1数据集","link":"#_4-1数据集","children":[]},{"level":3,"title":"4.2GCN参数设置","slug":"_4-2gcn参数设置","link":"#_4-2gcn参数设置","children":[]},{"level":3,"title":"4.3结果评估","slug":"_4-3结果评估","link":"#_4-3结果评估","children":[]},{"level":3,"title":"4.4将来研究方向","slug":"_4-4将来研究方向","link":"#_4-4将来研究方向","children":[]}]},{"level":2,"title":"5.个人总结及研究启示","slug":"_5-个人总结及研究启示","link":"#_5-个人总结及研究启示","children":[]}],"relativePath":"pages/posts/ML_NLP for phishing email.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/ML_NLP for phishing email.md","lastUpdated":1690730773000}'),o=JSON.parse('{"title":"恶意URL检测(十)应用ML和NLP的方法去检测钓鱼邮件","description":"","frontmatter":{"categories":"恶意URL检测","date":"2021-08-19T10:41:37.000Z","layout":"post","tags":null,"title":"恶意URL检测(十)应用ML和NLP的方法去检测钓鱼邮件"},"headers":[{"level":2,"title":"1.背景","slug":"_1-背景","link":"#_1-背景","children":[{"level":3,"title":"1.1刊物/会议级别","slug":"_1-1刊物-会议级别","link":"#_1-1刊物-会议级别","children":[]},{"level":3,"title":"1.2作者团队","slug":"_1-2作者团队","link":"#_1-2作者团队","children":[]},{"level":3,"title":"1.3文章创新点","slug":"_1-3文章创新点","link":"#_1-3文章创新点","children":[]}]},{"level":2,"title":"2.相关工作进展","slug":"_2-相关工作进展","link":"#_2-相关工作进展","children":[{"level":3,"title":"2.1特征选择","slug":"_2-1特征选择","link":"#_2-1特征选择","children":[]},{"level":3,"title":"2.2分类算法","slug":"_2-2分类算法","link":"#_2-2分类算法","children":[]}]},{"level":2,"title":"3.本文方法","slug":"_3-本文方法","link":"#_3-本文方法","children":[{"level":3,"title":"3.1数据预处理","slug":"_3-1数据预处理","link":"#_3-1数据预处理","children":[]},{"level":3,"title":"3.2图构建","slug":"_3-2图构建","link":"#_3-2图构建","children":[]},{"level":3,"title":"3.3GCN分类器","slug":"_3-3gcn分类器","link":"#_3-3gcn分类器","children":[]}]},{"level":2,"title":"4.实验结果及评估","slug":"_4-实验结果及评估","link":"#_4-实验结果及评估","children":[{"level":3,"title":"4.1数据集","slug":"_4-1数据集","link":"#_4-1数据集","children":[]},{"level":3,"title":"4.2GCN参数设置","slug":"_4-2gcn参数设置","link":"#_4-2gcn参数设置","children":[]},{"level":3,"title":"4.3结果评估","slug":"_4-3结果评估","link":"#_4-3结果评估","children":[]},{"level":3,"title":"4.4将来研究方向","slug":"_4-4将来研究方向","link":"#_4-4将来研究方向","children":[]}]},{"level":2,"title":"5.个人总结及研究启示","slug":"_5-个人总结及研究启示","link":"#_5-个人总结及研究启示","children":[]}],"relativePath":"pages/posts/ML_NLP for phishing email.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/ML_NLP for phishing email.md","lastUpdated":1690730773000}'),$={name:"pages/posts/ML_NLP for phishing email.md",data(){return{data:o,frontmatter:o.frontmatter,$frontmatter:o.frontmatter}},setup(){c("pageData",o)}},T={id:"_1-背景",tabindex:"-1"},x={id:"_1-1刊物-会议级别",tabindex:"-1"},R=e("p",null,"​ 2021年7月发表于Computers & Security ；刊物检索级别：SCI；影响因子2.849；",-1),G=e("p",null,"中科院分区：工程技术 3区 计算机：信息系统。属于CCF- B类文章。",-1),U={id:"_1-2作者团队",tabindex:"-1"},I=e("p",null,"​ 有两位作者，都来自沙特国王大学。",-1),S={id:"_1-3文章创新点",tabindex:"-1"},A=e("p",null,"1、 使用GCN去检测钓鱼邮件，并且检测对象是邮件的文本主体。",-1),F=e("p",null,"2、 本文方法只需要用到邮件的body text即可，而现有的方法大多需要用到邮件中的URL或其他信息。",-1),D=e("p",null,"3、 虽然本文提出的方法是部署在邮件服务器端去进行检测的，但是方法是通用的，也可在短信、推特等媒介进行钓鱼检测。",-1),E={id:"_2-相关工作进展",tabindex:"-1"},V=e("p",null,"​ 钓鱼攻击技术发展迅速，并且最常使用的方法是邮件钓鱼，所以需要有一定的手段对其进行防御。现有的技术可以大致分为两类：黑名单和机器学习的方法，以下重点关注机器学习的方法。为了提高分类性能，主要有两大类的改进方法：(1)使用不同的分类算法 (2)改进特征选择。",-1),w={id:"_2-1特征选择",tabindex:"-1"},B=e("ul",null,[e("li",null,[e("p",null,"[Aassal,2020] 提出了三类主要特征：header特征，包括时间戳、接收服务器(存疑，不理解为什么要是接收服务器)、内容格式等；body特征：文本和URL；第三大类特征是attachment。")]),e("li",null,[e("p",null,"[Toolan, 2010] 使用了40个特征，并且将他们分为了4大类：基于body；基于URL；基于subject；基于script的特征。结果证明基于body的特征效果最好。")])],-1),J={id:"_2-2分类算法",tabindex:"-1"},O=e("ul",null,[e("li",null,[e("p",null,"[Halgas, 2020] 提出，对于无结构的数据，如邮件的内容，深度学习算法最合适。")]),e("li",null,[e("p",null,"[Prasad, 2019] 证明在文本分类，深度学习的效果比NLP好。")]),e("li",null,[e("p",null,"[Lai ,2015] 使用了RCNN模型，使用最邻近结构去得到文本的上下文信息，同时使用CNN去构建一个文本的表示。多个模型比较后发现RCNN模型效果最好。")]),e("li",null,[e("p",null,"[Yao, 2019] 提出基于图神经网络的文本分类算法，即将整个语料库表示为一个图，并且使用图神经网络去学习词和文本嵌入。")]),e("li",null,[e("p",null,"[Fang, 2019] 提出了THEMIS分类模型，操作对象是邮件的头部和主体，随后使用Word2Vec去表示整个文本，模型使用RCNN深度学习模型。")]),e("li",null,[e("p",null,"[Almomani, 2013] 提出了动态发展神经fuzzy框架(本文介绍不多，可看原文了解)，它调整了进化连接系统。")])],-1),z={id:"_3-本文方法",tabindex:"-1"},K=e("p",null,"​ 本文使用NLP去处理电子邮件的body特征，并且使用GCN作为深度学习算法去检测钓鱼邮件。最开始输入的邮件包含有很多不相关的信息，需要进行图的构建。整体的操作流程如下图所示：",-1),j=e("p",null,[e("img",{src:m,alt:"1-frame"})],-1),H={id:"_3-1数据预处理",tabindex:"-1"},W=e("p",null,"​ 首先需要对数据进行预处理，清除一些不相关的字符、转换格式，以方便后续操作。预处理的操作如下：",-1),Z=e("p",null,"(1) 提取邮件中body文本的内容；",-1),X=e("p",null,"(2) 消除文本parsing所产生的空格；",-1),Y=e("p",null,"(3) 将所有字符转为小写，移除非字母的字符。",-1),q=e("p",null,"在具体实现时，是以下3个步骤实现的：",-1),Q=e("p",null,"(1) 邮件清理：清除掉邮件不相关的信息以及非英文的字符。伪代码语句如下图：",-1),ee=e("p",null,[e("img",{src:f,alt:"2-process"})],-1),le=e("p",null,"(2) Tokenization：基于空格，将邮件划分为词。具体实现的时候使用到了split()函数。",-1),te=e("p",null,"(3) 移除一些停词以及出现频率较低的词：使用NLTK的停词列表，并且出现次数<7次的词会被删除。伪代码如下：",-1),ne=e("p",null,[e("img",{src:L,alt:"3-process2"})],-1),ie={id:"_3-2图构建",tabindex:"-1"},se=e("p",null,"​ 从语料库中构建图，将词和邮件作为节点，连接两个词的边取决于两个节点共同出现的信息，而连接词和邮件的边是使用词频率和词的邮件频率构建的。这就将文本分类问题转化为了节点分类问题。",-1),_e=e("p",null,"​ 无向图G = (V, E)，用到了邻接矩阵A来表示无向图，矩阵中的值是每个关系的权重。边的值为两个词节点的同时出现频率，其计算方式如下图：",-1),oe=e("p",null,[e("img",{src:N,alt:"4-calculate"})],-1),ae=e("p",null,"其中P(I,J) 表示I和J同时出现的概率；如果是词和邮件，就计算TF- IDF的值。",-1),de={id:"_3-3gcn分类器",tabindex:"-1"},he=e("p",null,"​ GCN算法是半监督的学习算法，常用于文本分类，将文本分类的问题转化为节点分类问题。它的工作原理是：先通过整个邮件的语料库创建一个语料图，这样就将邮件表示为了节点图，节点中的每个图都包含着所有邻近节点的信息。随后将图输入到卷积神经网络中。",-1),re=e("p",null,"​ 在将邻近节点的信息进行传输之前，会进行scaled或归一化。Scaled方式如下：",-1),ce=e("p",null,[e("img",{src:v,alt:"5-scales"})],-1),ue=e("p",null,"​ 在GCN中，如果使用一个卷积神经网络层，那么节点只能从它的最邻近节点得到信息，因此需要更多的卷积层，并且需要的节点越多，需要的卷积层也就越多。[Kipf, 2017] 指出大多数都使用两到三层卷积层。",-1),pe=e("p",null,"​ 第一层计算如下：",-1),ge=e("p",null,[e("img",{src:k,alt:"6-firstcalcu"})],-1),me=e("p",null,"其中A～是scaled后的adjacency矩；X是A的identity矩；W是权重矩，可以用梯度下降去计算；p是激活函数。",-1),fe=e("p",null,"​ 其他层的计算如下：",-1),Le=e("p",null,[e("img",{src:b,alt:"7-otherlayer"})],-1),Ne=e("p",null,"​ 得到的邮件的特征矩阵输入到神经网络中，随后神经网络的隐藏层灰进行学习，随后输出层会进行判断，判定一个邮件是否是钓鱼文件。",-1),ve={id:"_4-实验结果及评估",tabindex:"-1"},ke={id:"_4-1数据集",tabindex:"-1"},be=e("p",null,"​ 使用[Radev, 2008] 提出的数据集，包含3685个钓鱼邮件，4894个合法的邮件。",-1),Pe={id:"_4-2gcn参数设置",tabindex:"-1"},Me=e("p",null,"参考[Kipf, 2017] 年的文章，参数设定如下：",-1),Ce=e("p",null,"学习率：0.1；",-1),ye=e("p",null,"Solver：Adam；",-1),$e=e("p",null,"Shuffle：True；",-1),Te=e("p",null,"Early stoping：10个epochs之后；",-1),xe=e("p",null,"GCN层数：2层；",-1),Re=e("p",null,"损失函数：交叉熵；",-1),Ge={id:"_4-3结果评估",tabindex:"-1"},Ue=e("p",null,"​ 使用的评价指标有：FP、TN、FN、TP、准确率、感知度、回召率和FPR。在评价分类器的有效性时，两种常用的方法是holdout和k -fold交叉验证。本文这两种方法都使用了，在holdout划分时，训练集和测试集的占比分别为70%和30%。同时，还使用了3-folds交叉验证的方法，把数据集分为了三组，分类器训练了三次。3-folds交叉验证的方法结果如下：",-1),Ie=e("p",null,[e("img",{src:P,alt:"8-3foldvalidation"})],-1),Se=e("p",null,"混淆矩阵的结果如下：",-1),Ae=e("p",null,[e("img",{src:M,alt:"9-confusionmatrix"})],-1),Fe=e("p",null,[l("其他指标结果如下： "),e("img",{src:C,alt:"10-othervalues"})],-1),De=e("p",null,[l("同时，又将现有的结果与其他方法进行比较，结果如下图所示： "),e("img",{src:y,alt:"11-othervalues"})],-1),Ee=e("p",null,"​ 虽然有一些方法看似性能更好，但是与他们相比，本文方法所使用到的数据更少，且没有手动特征选取阶段。",-1),Ve=e("p",null,"​ 有的方法用到了图像，但是耗时更久。",-1),we=e("p",null,"​ 时间复杂度：本文方法的时间复杂度为O(LED+LND2)，空间复杂度为O(E)，其中L是层数，N是总节点数，D是特征纬度，E是图的边数。平均训练6005个邮件的时间为3.89分。",-1),Be={id:"_4-4将来研究方向",tabindex:"-1"},Je=e("p",null,"(1) 研究非英语语言的邮件",-1),Oe=e("p",null,"(2) 将此方法应用于邮件分类",-1),ze=e("p",null,"(3) 在真实环境中检测0day 钓鱼邮件",-1),Ke={id:"_5-个人总结及研究启示",tabindex:"-1"},je=e("p",null,"1、本文概述：",-1),He=e("p",null,"操作对象：电子邮件主体",-1),We=e("p",null,"深度学习算法：图卷积神经网络 (GCN) / NLP",-1),Ze=e("p",null,"2、文章局限性",-1),Xe=e("p",null,"只能检测英文语言的邮件；",-1),Ye=e("p",null,"所使用的数据集有点老，是2008年的；",-1),qe=e("p",null,"没有创新性较大的内容；",-1);function Qe(s,el,ll,tl,a,nl){const n=g,d=h;return p(),u(d,{frontmatter:a.frontmatter,data:a.data},{"main-content-md":t(()=>[e("h2",T,[l("1.背景 "),i(n,{class:"header-anchor",href:"#_1-背景","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),e("h3",x,[l("1.1刊物/会议级别 "),i(n,{class:"header-anchor",href:"#_1-1刊物-会议级别","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),R,G,e("h3",U,[l("1.2作者团队 "),i(n,{class:"header-anchor",href:"#_1-2作者团队","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),I,e("h3",S,[l("1.3文章创新点 "),i(n,{class:"header-anchor",href:"#_1-3文章创新点","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),A,F,D,e("h2",E,[l("2.相关工作进展 "),i(n,{class:"header-anchor",href:"#_2-相关工作进展","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),V,e("h3",w,[l("2.1特征选择 "),i(n,{class:"header-anchor",href:"#_2-1特征选择","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),B,e("h3",J,[l("2.2分类算法 "),i(n,{class:"header-anchor",href:"#_2-2分类算法","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),O,e("h2",z,[l("3.本文方法 "),i(n,{class:"header-anchor",href:"#_3-本文方法","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),K,j,e("h3",H,[l("3.1数据预处理 "),i(n,{class:"header-anchor",href:"#_3-1数据预处理","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),W,Z,X,Y,q,Q,ee,le,te,ne,e("h3",ie,[l("3.2图构建 "),i(n,{class:"header-anchor",href:"#_3-2图构建","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),se,_e,oe,ae,e("h3",de,[l("3.3GCN分类器 "),i(n,{class:"header-anchor",href:"#_3-3gcn分类器","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),he,re,ce,ue,pe,ge,me,fe,Le,Ne,e("h2",ve,[l("4.实验结果及评估 "),i(n,{class:"header-anchor",href:"#_4-实验结果及评估","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),e("h3",ke,[l("4.1数据集 "),i(n,{class:"header-anchor",href:"#_4-1数据集","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),be,e("h3",Pe,[l("4.2GCN参数设置 "),i(n,{class:"header-anchor",href:"#_4-2gcn参数设置","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),Me,Ce,ye,$e,Te,xe,Re,e("h3",Ge,[l("4.3结果评估 "),i(n,{class:"header-anchor",href:"#_4-3结果评估","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),Ue,Ie,Se,Ae,Fe,De,Ee,Ve,we,e("h3",Be,[l("4.4将来研究方向 "),i(n,{class:"header-anchor",href:"#_4-4将来研究方向","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),Je,Oe,ze,e("h2",Ke,[l("5.个人总结及研究启示 "),i(n,{class:"header-anchor",href:"#_5-个人总结及研究启示","aria-hidden":"true"},{default:t(()=>[l("#")]),_:1})]),je,He,We,Ze,Xe,Ye,qe]),"main-header":t(()=>[_(s.$slots,"main-header")]),"main-header-after":t(()=>[_(s.$slots,"main-header-after")]),"main-nav":t(()=>[_(s.$slots,"main-nav")]),"main-content":t(()=>[_(s.$slots,"main-content")]),"main-content-after":t(()=>[_(s.$slots,"main-content-after")]),"main-nav-before":t(()=>[_(s.$slots,"main-nav-before")]),"main-nav-after":t(()=>[_(s.$slots,"main-nav-after")]),comment:t(()=>[_(s.$slots,"comment")]),footer:t(()=>[_(s.$slots,"footer")]),aside:t(()=>[_(s.$slots,"aside")]),"aside-custom":t(()=>[_(s.$slots,"aside-custom")]),default:t(()=>[_(s.$slots,"default")]),_:3},8,["frontmatter","data"])}const hl=r($,[["render",Qe]]);export{dl as __pageData,hl as default};
