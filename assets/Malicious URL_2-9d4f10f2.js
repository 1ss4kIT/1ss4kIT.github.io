import{_ as F}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as D,p as y,c as A,w as o,o as i,a as s,b as l,d as a,r as n,e as C}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const _="/images/pasted-232.png",d="/images/pasted-233.png",u="/images/pasted-234.png",h="/images/pasted-235.png",f="/images/pasted-236.png",Ll=JSON.parse('{"title":"恶意URL检测(二)用户角度SVM","description":"","frontmatter":{"layout":"post","title":"恶意URL检测(二)用户角度SVM","tags":["恶意url检测"],"categories":["恶意URL检测"],"date":"2021-01-23T16:37:00.000Z"},"headers":[],"relativePath":"pages/posts/Malicious URL_2.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/Malicious URL_2.md","lastUpdated":1690730773000}'),c=JSON.parse('{"title":"恶意URL检测(二)用户角度SVM","description":"","frontmatter":{"layout":"post","title":"恶意URL检测(二)用户角度SVM","tags":["恶意url检测"],"categories":["恶意URL检测"],"date":"2021-01-23T16:37:00.000Z"},"headers":[],"relativePath":"pages/posts/Malicious URL_2.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/Malicious URL_2.md","lastUpdated":1690730773000}'),m={name:"pages/posts/Malicious URL_2.md",data(){return{data:c,frontmatter:c.frontmatter,$frontmatter:c.frontmatter}},setup(){y("pageData",c)}},g={id:"一、机器学习实现恶意url检测",tabindex:"-1"},w=s("p",null,"1、处理数据",-1),b=s("p",null,"POST请求，URL要加上请求的主体内容。",-1),k=s("p",null,"2、改进点",-1),v=s("ul",null,[s("li",null,"细分攻击类型"),s("li",null,"优化TF-IDF，如考虑词袋+TF-IDF，或利用TF- IDF将URL中不重要的部分进行泛化处理。"),s("li",null,"使用深度学习")],-1),E=s("p",null,"3、词袋+TF-IDF+cnn",-1),L=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#get_features_by_wordbag_tfidf()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    x "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," vectorizer"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"fit_transform"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"queries"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    x "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," x"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"toarray"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    transformer "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"TfidfTransformer"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"smooth_idf"),s("span",{style:{color:"#89DDFF"}},"=False)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    tfidf "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," transformer"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"fit_transform"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"x"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    x "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," tfidf"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"toarray"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," x"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," y")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#分割数据集")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," x_train"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," x_test"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," y_train"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," y_test "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"train_test_split"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"x"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," y"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"test_size"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0.4"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"random_state"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#do_cnn_wordbag_tfidf(x_train, x_test, y_train, y_test)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    trainX "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"pad_sequences"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"trainX"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"value"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},".)"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    testX "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"pad_sequences"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"testX"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"value"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},".)"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#填充")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    trainY "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"to_categorical"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"trainY"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"nb_classes"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    testY "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"to_categorical"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"testY"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"nb_classes"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#将类别向量转换为二进制（只有0和1）的矩阵类型表示")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"input_data"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"name"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"input"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," tflearn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"embedding"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"input_dim"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"1000000"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"output_dim"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"128"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    branch1 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"conv_1d"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"128"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"padding"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"valid"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"activation"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"relu"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"regularizer"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"L2"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    branch2 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"conv_1d"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"128"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"padding"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"valid"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"activation"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"relu"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"regularizer"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"L2"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    branch3 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"conv_1d"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"128"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"5"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"padding"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"valid"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"activation"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"relu"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"regularizer"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"L2"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"merge"),s("span",{style:{color:"#89DDFF"}},"(["),s("span",{style:{color:"#82AAFF"}},"branch1"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," branch2"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," branch3"),s("span",{style:{color:"#89DDFF"}},"],"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"mode"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"concat"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"axis"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," tf"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"expand_dims"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"global_max_pool"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"dropout"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"0.8"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"fully_connected"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"activation"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"softmax"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"regression"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"optimizer"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"adam"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"learning_rate"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0.001"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"loss"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"categorical_crossentropy"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"name"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"target"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    model "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," tflearn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"DNN"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"network"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"tensorboard_verbose"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    model"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"fit"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"trainX"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," trainY"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"n_epoch"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"5"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"shuffle"),s("span",{style:{color:"#89DDFF"}},"=True,"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"validation_set"),s("span",{style:{color:"#89DDFF"}},"=("),s("span",{style:{color:"#82AAFF"}},"testX"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," testY"),s("span",{style:{color:"#89DDFF"}},"),"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"show_metric"),s("span",{style:{color:"#89DDFF"}},"=True,"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"batch_size"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"100"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"run_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"url"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),R=s("p",null,"4、改进版本1---从pcap中提取数据",-1),U=s("p",null,"第一个改进的点是 从pcap中提取url。核心代码如下",-1),T=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"get_url"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"pkt"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"not"),s("span",{style:{color:"#A6ACCD"}}," pkt"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"haslayer"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"http"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"HTTPRequest"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# This packet doesn't contain an HTTP request so we skip it")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    http_layer "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," pkt"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"http"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"HTTPRequest"),s("span",{style:{color:"#89DDFF"}},"]."),s("span",{style:{color:"#F07178"}},"fields")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    req_url "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," http_layer"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"Path"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]."),s("span",{style:{color:"#82AAFF"}},"decode"),s("span",{style:{color:"#89DDFF"}},"()"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    req_list"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"append"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"req_url"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),x=s("p",null,"5、改进2---扩展了新的数据集",-1),M=s("p",null,"从安全设备上收集了部分数据集，虽然覆盖面不是很广，但也算是一个小小的进展。",-1),$=s("p",null,"模型还用到kmeans进行降维，但是我之前已经看过了，此处不再记录。",-1),P={id:"二、基于url的恶意访问检测方法",tabindex:"-1"},q=s("p",null,"发表于 通信学报",-1),z=s("p",null,"1、特征",-1),I=s("p",null,[s("strong",null,"(1)时间窗口内域名访问相似度D，来剔除大部分规律频发流量，即良性的访问"),l("。D为欧式距离。")],-1),S=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#A6ACCD"}}," numpy "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"as"),s("span",{style:{color:"#A6ACCD"}}," np")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"x"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"random"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"random"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"y"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"random"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"random"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#方法一：根据公式求解")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"d1"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"sqrt"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"sum"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"square"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"x"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#82AAFF"}},"y"),s("span",{style:{color:"#89DDFF"}},")))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#方法二：根据scipy库求解")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#A6ACCD"}}," scipy"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"spatial"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"distance "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#A6ACCD"}}," pdist")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"X"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"np"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"vstack"),s("span",{style:{color:"#89DDFF"}},"(["),s("span",{style:{color:"#82AAFF"}},"x"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}},"y"),s("span",{style:{color:"#89DDFF"}},"])"),s("span",{style:{color:"#A6ACCD"}},"           "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#将x,y两个一维数组合并成一个2D数组 ；[[x1,x2,x3...],[y1,y2,y3...]]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"d2"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"pdist"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"X"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},"                  "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#d2=np.sqrt(（x1-y1)")])])])],-1),j=s("p",null,[s("img",{src:_,alt:"upload successful"})],-1),N=s("p",null,"D越小，访问约有规律，越可能是良性数据。",-1),V=s("p",null,[s("strong",null,"(2)URI参数信息熵H")],-1),X=s("p",null,"攻击的URI一般需要携带很多参数，熵就会较大。",-1),H=s("p",null,"代码如下",-1),O=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#python2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"minDistance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"word1"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"word2"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"not"),s("span",{style:{color:"#A6ACCD"}}," word1"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"word2 "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"or"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},"''"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"or"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"not"),s("span",{style:{color:"#A6ACCD"}}," word2"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"word1 "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"or"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},"''"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"or"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    size1 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"word1"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    size2 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"word2"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    last "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    tmp "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"range"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"size2 "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    value "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"None")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," i "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"range"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"size1"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        tmp"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," i "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        last "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," i")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# print word1[i], last, tmp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," j "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"range"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"size2"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," word1"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"i"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#A6ACCD"}}," word2"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"j"),s("span",{style:{color:"#89DDFF"}},"]:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                value "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," last")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"else"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                value "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"min"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"last"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," tmp"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#82AAFF"}},"j"),s("span",{style:{color:"#89DDFF"}},"],"),s("span",{style:{color:"#82AAFF"}}," tmp"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#82AAFF"}},"j "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},"])")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# print(last, tmp[j], tmp[j + 1], value)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            last "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," tmp"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"j"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            tmp"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"j"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," value")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# print tmp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," value")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"minDistance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"intention"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"execution"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"))")])])])],-1),Y=s("p",null,"它用来衡量两个文本之间的相似度，值越大，说明越不相似。求出ld。",-1),B=s("p",null,"字符串S与T的相似度求解如下：LCS是最长公共子串。",-1),K=s("p",null,[s("img",{src:d,alt:"upload successful"})],-1),J=s("p",null,"下面进行聚类，分成K类。最后信息熵计算如下：",-1),Z=s("p",null,[s("img",{src:u,alt:"upload successful"})],-1),G=s("p",null,"熵越大，越可能是恶意数据。",-1),Q=s("p",null,[s("strong",null,"(3)异常时间访问频发度P")],-1),W=s("p",null,"(即功率谱密度)",-1),ss=s("p",null,"此处用到随机过程的知识。可以得到时间序列x(t)的异常时间频发度。",-1),ls=s("p",null,"值越大，越有可能是恶意数据。",-1),os=s("p",null,[s("strong",null,"(4)设备类型异样性P")],-1),ts=s("p",null,"设备种类越多，P值越大",-1),ns=s("p",null,[s("img",{src:h,alt:"upload successful"})],-1),es=s("p",null,[s("strong",null,"(5)网站标签分类")],-1),as=s("p",null,"目的是剔除：高频善意流量。",-1),cs=s("p",null,"方法：深度包检测。",-1),ps=s("p",null,"结合应用协议的特征，判断流量所属的应用。此处指找出是否是HTTP应用。",-1),rs=s("p",null,"提取出以上5个特征之后，将日志向量化。",-1),Fs=s("p",null,"2、模型",-1),Ds=s("p",null,"模型使用 混合高斯聚类算法。",-1),ys=s("p",null,"步骤如下：",-1),As=s("p",null,"​ 求出样本集的各个参数 ---> 求出样本的后验概率 ---> 迭代确定模型的参数，确定簇的划分 ---> 得到新的特征向量。",-1),is=s("p",null,"3、实验",-1),Cs=s("p",null,"角度：用户访问行为是否恶意。数据是以用户为单位，输出其7天内的访问数据集.cvs文件。",-1),_s=s("p",null,"实验发现：网站标签分类效果不好，可能原因是 还无法Https等加密流量。",-1),ds=s("p",null,"参数选择：根据下图",-1),us=s("p",null,[s("img",{src:f,alt:"upload successful"})],-1),hs=s("p",null,"可以看出，当聚类数目K=2时，参数选择 完全协方差矩阵，效果最好～",-1),fs=s("p",null,"收获及启发",-1),ms=s("p",null,"1、恶意访问不仅包括一些普通攻击，也包括恶意爬虫，恶意软件访问等。此处最好还是专注于研究一个：恶意URL。",-1),gs=s("p",null,"2、有人提出基于URL词汇特征 和 wHOIS信息的静态挖掘模型。",-1),ws=s("p",null,"3、本文用到的几个特征都挺有道理的，具有参考性。",-1),bs=s("p",null,"4、之前看到的文章用了Kmeans，是用来预处理的时候对数据进行降维处理的。此处的聚类模型就是我们的分类模型，用来划分良性和恶意数据。",-1),ks=s("p",null,"5、本文的检测角度不是再针对于单个URL了，而是分析用户的行为，看是否属于恶意访问。",-1),vs={id:"三、基于url的恶意访问识别系统的设计与实现",tabindex:"-1"},Es=s("p",null,"​ 本文是一篇硕士毕业论文，也是前一篇文章的超长扩展版，作者来自于北京邮电大学，时间为2019年，较新。笔记也按照作者的写作思路来记录。",-1),Ls=s("p",null,[s("strong",null,"1、绪论")],-1),Rs=s("p",null,"本文选用人工标记与聚类相结合的方法，人工校正一部分比较模糊的结果。",-1),Us=s("p",null,"采用S4VM模型",-1),Ts=s("p",null,[s("strong",null,"2、相关技术")],-1),xs=s("p",null,"1、Levenshtein距离",-1),Ms=s("p",null,"P5有个小错误，应该是值越大，字符串的相似度越小。",-1),$s=s("p",null,"2、深度包检测 DPI",-1),Ps=s("p",null,"但是，加密数据不可见",-1),qs=s("p",null,"3、信息熵",-1),zs=s("p",null,"量化了不确定性",-1),Is=s("p",null,"4、层次聚类",-1),Ss=s("p",null,"是聚类的一种。",-1),js=s("p",null,"...(省略了几个，因为去上厕所了没做笔记)",-1),Ns=s("p",null,"5、平均功率谱密度",-1),Vs=s("p",null,"定义：随机过程的自相关函数的傅立叶变换。",-1),Xs=s("p",null,"6、半监督分类算法",-1),Hs=s("p",null,"可以使用未标记的数据",-1),Os=s("p",null,"7、半监督支持向量机",-1),Ys=s("p",null,"软间隔：允许在一些样本上出错。",-1),Bs=s("p",null,"8、评估指标",-1),Ks=s("p",null,"混淆矩阵",-1),Js=s("p",null,"准确率：预测对了的/总共的 (但是有可能存在准确度悖论)",-1),Zs=s("p",null,"ROC曲线：真阳性为纵坐标，假阳性为横坐标",-1),Gs=s("p",null,"AUC：ROC曲线围成的面积",-1),Qs=s("p",null,[s("strong",null,"3、模型")],-1),Ws=s("p",null,"恶意访问的特性：",-1),sl=s("p",null,"[非规律高频性、大量访问参数、时间异常性、访问设备多样性、应用类型未知性]",-1),ll=s("p",null,"为了结果有更高的准确性，将模型输出结果中：恶意概率为[0.3,0.7]区间内的结果重新进行人工划分。",-1),ol=s("p",null,"具体求解的时候采用了模拟退火方法。",-1),tl=s("p",null,"评估：训练集与测试集 9:1，还选取了模型参数。实验发现选择数据集D5效果最好，RBF核函数优于线性函数，并且选择的参数，C1=40，C2=10，gamma=0.2",-1),nl=s("p",null,[s("strong",null,"4、5、6恶意访问识别系统设计")],-1),el=s("p",null,"之前说的内容大部分都在小论文中包含了，这里是系统设计的步骤。",-1),al=s("p",null,"输入的数据来源于网络日志，并且是以用户为单位的。",-1),cl=s("p",null,"前面的才是比较重要的内容，感觉后面的都是凑字数的...",-1),pl=s("p",null,"然后写了各个模块的功能，用Django框架，以及各个模块怎么实现。",-1),rl=s("p",null,[s("strong",null,"7、总结与展望")],-1),Fl=s("p",null,"总结不说了，展望如下：",-1),Dl=s("p",null,"(1)设计的系统， 引入对系统的鉴权，明确各个角色的不同权限。阻止他们对超过自己权限的访问。",-1),yl=s("p",null,"(2)优化前端页面",-1),Al=s("p",null,"...对我没什么用处",-1),il=s("p",null,"收获：",-1),Cl=s("p",null,"1、可以用人工标记的方法配合模型。",-1),_l=s("p",null,"2、对于用哪部分数据 以及参数如何选择，可以提前进行一下小测验，选出我们最优的参数。",-1),dl=s("p",null,"3、写毕业论文的时候，如果字数不够，可以用系统设计的步骤来凑字数，就是什么什么模块的功能之类的。",-1);function ul(t,hl,fl,ml,p,gl){const e=C,r=F;return i(),A(r,{frontmatter:p.frontmatter,data:p.data},{"main-content-md":o(()=>[s("h1",g,[l("一、机器学习实现恶意URL检测 "),a(e,{class:"header-anchor",href:"#一、机器学习实现恶意url检测","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("p",null,[l("文章3地址 "),a(e,{href:"https://coldwave96.github.io/2019/11/08/MaliciousURLs/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://coldwave96.github.io/2019/11/08/MaliciousURLs/")]),_:1})]),w,b,k,v,E,s("p",null,[l("文章3给出的参考代码中("),a(e,{href:"https://github.com/Coldwave96/MaliciousURLs",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://github.com/Coldwave96/MaliciousURLs")]),_:1}),l(")，给出了第二/三个改进点的代码，大致思路如下")]),L,s("p",null,[l("代码不太能看懂，是使用了tflearn训练CNN模型，具体可参考 "),a(e,{href:"https://blog.csdn.net/luoyexuge/article/details/78243117",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://blog.csdn.net/luoyexuge/article/details/78243117")]),_:1})]),R,s("p",null,[l("随后作者提出了改进版本，文章4地址 "),a(e,{href:"https://coldwave96.github.io/2020/04/20/MaliciousURLs2/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://coldwave96.github.io/2020/04/20/MaliciousURLs2/")]),_:1}),l(" 代码4地址"),a(e,{href:"https://github.com/Coldwave96/MaliciousUrls_Part2",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://github.com/Coldwave96/MaliciousUrls_Part2")]),_:1})]),U,T,x,M,$,s("h1",P,[l("二、基于URL的恶意访问检测方法 "),a(e,{class:"header-anchor",href:"#二、基于url的恶意访问检测方法","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("p",null,[l("文章地址 "),a(e,{href:"https://www.doc88.com/p-0428451872060.html",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://www.doc88.com/p-0428451872060.html")]),_:1})]),q,z,I,s("p",null,[l("参考"),a(e,{href:"https://www.cnblogs.com/gegemu/p/9968014.html",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://www.cnblogs.com/gegemu/p/9968014.html")]),_:1}),l(" 欧式距离计算如下")]),S,j,N,V,X,s("p",null,[l("文中用到了Levenshtein算法。算法原理见文章 "),a(e,{href:"https://blog.csdn.net/lijieshare/article/details/84832984",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://blog.csdn.net/lijieshare/article/details/84832984")]),_:1})]),H,O,Y,B,K,J,Z,G,Q,W,ss,ls,os,ts,ns,es,as,cs,ps,rs,Fs,Ds,ys,As,is,Cs,_s,ds,us,hs,fs,ms,gs,ws,bs,ks,s("h1",vs,[l("三、基于URL的恶意访问识别系统的设计与实现 "),a(e,{class:"header-anchor",href:"#三、基于url的恶意访问识别系统的设计与实现","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Es,Ls,Rs,Us,Ts,xs,Ms,$s,Ps,qs,zs,Is,Ss,js,Ns,Vs,Xs,Hs,Os,Ys,Bs,Ks,Js,Zs,Gs,Qs,Ws,sl,ll,ol,tl,nl,el,al,cl,pl,rl,Fl,Dl,yl,Al,il,Cl,_l,dl]),"main-header":o(()=>[n(t.$slots,"main-header")]),"main-header-after":o(()=>[n(t.$slots,"main-header-after")]),"main-nav":o(()=>[n(t.$slots,"main-nav")]),"main-content":o(()=>[n(t.$slots,"main-content")]),"main-content-after":o(()=>[n(t.$slots,"main-content-after")]),"main-nav-before":o(()=>[n(t.$slots,"main-nav-before")]),"main-nav-after":o(()=>[n(t.$slots,"main-nav-after")]),comment:o(()=>[n(t.$slots,"comment")]),footer:o(()=>[n(t.$slots,"footer")]),aside:o(()=>[n(t.$slots,"aside")]),"aside-custom":o(()=>[n(t.$slots,"aside-custom")]),default:o(()=>[n(t.$slots,"default")]),_:3},8,["frontmatter","data"])}const Rl=D(m,[["render",ul]]);export{Ll as __pageData,Rl as default};
