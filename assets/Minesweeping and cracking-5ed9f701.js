import{_ as p}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as d,p as _,c as h,w as n,o as u,a as e,b as t,d as l,r as a,e as m}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const g="/Minesweeping_and_cracking/1-wirteflag.png",f="/Minesweeping_and_cracking/2-CE.png",D="/Minesweeping_and_cracking/3-bp.png",y="/Minesweeping_and_cracking/4-timestop.png",b="/Minesweeping_and_cracking/5-0x1564.jpg",w="/Minesweeping_and_cracking/6-gameover.jpg",C="/Minesweeping_and_cracking/6-endchange.jpg",A="/Minesweeping_and_cracking/7-afterboom.jpg",Be=JSON.parse('{"title":"扫雷破解","description":"","frontmatter":{"categories":"二进制","date":"2022-01-21T21:49:26.000Z","layout":"post","tags":null,"title":"扫雷破解"},"headers":[{"level":2,"title":"0. 破解","slug":"_0-破解","link":"#_0-破解","children":[]},{"level":2,"title":"1. 自动玩游戏","slug":"_1-自动玩游戏","link":"#_1-自动玩游戏","children":[]}],"relativePath":"pages/posts/Minesweeping and cracking.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/Minesweeping and cracking.md","lastUpdated":1690730773000}'),r=JSON.parse('{"title":"扫雷破解","description":"","frontmatter":{"categories":"二进制","date":"2022-01-21T21:49:26.000Z","layout":"post","tags":null,"title":"扫雷破解"},"headers":[{"level":2,"title":"0. 破解","slug":"_0-破解","link":"#_0-破解","children":[]},{"level":2,"title":"1. 自动玩游戏","slug":"_1-自动玩游戏","link":"#_1-自动玩游戏","children":[]}],"relativePath":"pages/posts/Minesweeping and cracking.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/Minesweeping and cracking.md","lastUpdated":1690730773000}'),F={name:"pages/posts/Minesweeping and cracking.md",data(){return{data:r,frontmatter:r.frontmatter,$frontmatter:r.frontmatter}},setup(){_("pageData",r)}},k={id:"_0-破解",tabindex:"-1"},E=e("p",null,"Ollydbg的存储位置为 C:\\Program Files (x86)。",-1),B=e("p",null,"1、程序运行时输出flag",-1),M=e("p",null,"ida将exe作为PE文件打开。",-1),x=e("p",null,"rand生成的随机数%9，保证了炸弹的坐标在9*9的矩阵内。",-1),j=e("p",null,"esi = 随机数+1，用于确定列",-1),v=e("p",null,"ecx = (随机数 + 1) * 32，用于确定行的位置",-1),z=e("p",null,"根据行列找到相应的位置，与0x80做test，之后是jnz。即如果此处位置的第8位是1，就跳转回去，运行rand寻找下一个块。如果第8位是0，即跳出循环，运行之后的内容，将其改为8开头的。【这边没设置过的时候，所有位置上的值都是OF，表示没有放置炸弹，放置过之后变为8F。这边有个分支判断是为了防止之前防止过炸弹的地方重复放置。】",-1),$=e("p",null,[e("em",null,"dword_1005330"),t("控制循环次数，即炸弹的个数。最开始设置的是0xA。")],-1),S=e("p",null,"在内存某处下断点，单步调试，发现flag的值为0x0E。无数字的值为0x40，有数字再加上相应的数字的值。0x10代表墙壁。未点击时为0xf。",-1),O=e("p",null,"用XOR指令代替原来的OR指令，就能在放置炸弹的时候将0x8F变为0x8E。",-1),N=e("p",null,[t("修改之后的程序运行初始就标记出了所有雷区的位置，如下图所示。 "),e("img",{src:g,alt:"1-wirteflag"})],-1),T=e("p",null,"文章还提到了一种破解的方法，即在输出时，将mine输出为flag。",-1),P=e("p",null,"此外还参考了一些其他文章。",-1),R=e("p",null,"2、让计时器停止",-1),I=e("p",null,"最初关注SetTimer函数，后来发现其不是使得时间增加的关键。",-1),W=e("p",null,[t("使得时间增加的是"),e("code",null,"0x1003830"),t("处的"),e("code",null,"INC DWORD PTR DS:[100579C]"),t("，将其改为"),e("code",null,"NOP"),t("。")],-1),L=e("p",null,"随后保存操作如下：",-1),U=e("div",{class:"language-python"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"Click on "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"Assemble"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"and"),e("span",{style:{color:"#A6ACCD"}}," then hit Esc "),e("span",{style:{color:"#89DDFF"}},"or"),e("span",{style:{color:"#A6ACCD"}}," choose "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"Cancel"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},".")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"Right"),e("span",{style:{color:"#89DDFF"}},"-"),e("span",{style:{color:"#A6ACCD"}},"click on the disassembly window "),e("span",{style:{color:"#89DDFF"}},"and"),e("span",{style:{color:"#A6ACCD"}}," choose "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"Copy to executable"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},">"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"All modifications"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},".")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"Click on "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"Copy all"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},".")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"Right"),e("span",{style:{color:"#89DDFF"}},"-"),e("span",{style:{color:"#A6ACCD"}},"click again"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," choose "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"Save file"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"and"),e("span",{style:{color:"#A6ACCD"}}," specify both location "),e("span",{style:{color:"#89DDFF"}},"and"),e("span",{style:{color:"#A6ACCD"}}," name to the newly patched file"),e("span",{style:{color:"#89DDFF"}},".")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"Open the file "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),e("span",{style:{color:"#A6ACCD"}}," its location"),e("span",{style:{color:"#89DDFF"}},".")])])])],-1),q=e("code",null,"100579C",-1),V=e("p",null,[e("img",{src:f,alt:"2-CE"})],-1),J=e("p",null,"但是自己操作的时候发现不管是nop单个的一行还是nop一小段，都没有让时间停下来。",-1),K=e("p",null,[t("重新在"),e("code",null,"100579C"),t("处下写断点，发现如果此时计数器的值不是0，就不是停在刚才说的"),e("code",null,"0x1003830"),t("，而是断在"),e("code",null,"0x1002FF5"),t("，将其改为nop。")],-1),Z=e("p",null,[e("img",{src:D,alt:"3-bp.png"})],-1),X=e("p",null,[t("时间停止在了1秒。可能因为最开始的从0到1秒和1秒之后的秒数增加不在同一个位置处理，那么合理推测，"),e("code",null,"0x1003830"),t("处的INC是使得时间从0秒增加到1秒。将其也改为nop，此时时间就停在了0秒。")],-1),G=e("p",null,[e("img",{src:y,alt:"4-timestop"})],-1),H=e("p",null,"3、点到雷不会结束游戏",-1),Q=e("p",null,[t("此处是时间增加的代码。时间增加的条件为"),e("code",null,"dword_1005164"),t("不为0，且当前时间 < 999。")],-1),Y=e("p",null,[e("img",{src:b,alt:"5-0x1564"})],-1),ee=e("p",null,[t("猜测"),e("code",null,"dword_1005164"),t("用来记录游戏是否结束，若其值为0，则游戏结束。ollydbg调试验证，发现猜想是正确的。初始化后其值为0，用户点击之后游戏开始，值变为1，用户踩到雷区，值变为0。赋值语句如下图所示。[傻傻地直接将这句改为NOP，意料之中地失败了]")],-1),te=e("p",null,[e("img",{src:w,alt:"6-gameover"})],-1),ne=e("p",null,[t("这条指令往上追踪，到了"),e("code",null,"sub_1003512"),t("函数。")],-1),se=e("p",null,[t("再往上追踪，到了"),e("code",null,"sub_10037E1"),t("函数。")],-1),le=e("p",null,[t("再往上，到了"),e("code",null,"sub_1001BC9"),t("函数。游戏的状态与"),e("code",null,"dword_1005000"),t("处的值有关。游戏未开始时其值为0x18，开始之后为0x01，踩到雷之后变为0x10。在该地址处插入写入断点，踩到雷后跳转到0x010034D6。")],-1),oe=e("p",null,[e("img",{src:C,alt:"6-endchange"})],-1),ae=e("p",null,"将该段代码修改为NOP，踩到雷之后还能继续玩～",-1),re=e("p",null,[e("img",{src:A,alt:"7-afterboom"})],-1),ie={id:"_1-自动玩游戏",tabindex:"-1"},ce=e("p",null,"1、内存中读取雷区布局",-1),pe=e("p",null,"模拟鼠标点击事件，点击非雷区的块。",-1),de=e("div",{class:"language-c++"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"SendMessage(hWinmine,WM_LBUTTONDOWN,0,MAKELPARAM(xBegin-mSize/2+mSize*j,")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"                    yBegin+mSize/2+mSize*i));")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"SendMessage(hWinmine,WM_LBUTTONUP,0,MAKELPARAM(xBegin-mSize/2+mSize*j,")]),t(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"                    yBegin+mSize/2+mSize*i));")])])])],-1),_e=e("p",null,"2、编写点击的规则，让机器像人一样去玩耍",-1),he=e("p",null,"3、机器学习解决方案",-1),ue=e("p",null,"2022.1.24",-1),me=e("p",null,"原本还有以上两种思路，但是现在心情不好，并且看扫雷已经3天了有点厌烦了，就先做到这个程度吧。",-1),ge=e("p",null,"其他可参考文章",-1);function fe(o,De,ye,be,i,we){const s=m,c=p;return u(),h(c,{frontmatter:i.frontmatter,data:i.data},{"main-content-md":n(()=>[e("h2",k,[t("0. 破解 "),l(s,{class:"header-anchor",href:"#_0-破解","aria-hidden":"true"},{default:n(()=>[t("#")]),_:1})]),E,B,e("p",null,[l(s,{href:"https://www.begin.re/hacking-minesweeper",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.begin.re/hacking-minesweeper")]),_:1}),t(" 这篇写的太详细太棒太好了，一定要看！每条指令每步操作都写的清清楚楚明明白白 [需要翻墙] & [post 3 years ago]。")]),M,x,j,v,z,$,S,O,N,T,P,e("p",null,[t("【1】"),l(s,{href:"https://pediy.com/kssd/pediy12/138855.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("2011年的这篇《用IDA Pro + OD 来分析扫雷》")]),_:1}),t(" 描述了从main函数找到rand函数的过程。")]),e("p",null,[t("【2】"),l(s,{href:"https://blog.csdn.net/nightsay/article/details/45540129",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("逆向-扫雷算法分析")]),_:1}),t("，前半部分和【1】差不多，后半部分分析了生成雷区的函数。")]),R,e("p",null,[t("参考这篇来操作："),l(s,{href:"https://www.twblogs.net/a/5b82117d2b71772165af7d11",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.twblogs.net/a/5b82117d2b71772165af7d11")]),_:1}),t(" 。")]),I,W,L,U,e("p",null,[t("关于如何找到内存地址"),q,t("，也可以使用CE。"),l(s,{href:"https://www.52pojie.cn/thread-1031125-1-1.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("CE破解参考教程")]),_:1})]),V,J,K,Z,X,G,H,e("p",null,[t("参考文章："),l(s,{href:"https://www.52pojie.cn/thread-1174768-1-1.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.52pojie.cn/thread-1174768-1-1.html")]),_:1})]),Q,Y,ee,te,e("p",null,[t("随后又参考这篇文章："),l(s,{href:"https://www.dazhuanlan.com/jx0416/topics/1379548",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.dazhuanlan.com/jx0416/topics/1379548")]),_:1})]),ne,se,le,oe,ae,re,e("h2",ie,[t("1. 自动玩游戏 "),l(s,{class:"header-anchor",href:"#_1-自动玩游戏","aria-hidden":"true"},{default:n(()=>[t("#")]),_:1})]),ce,e("p",null,[t("参考文章 "),l(s,{href:"https://www.dazhuanlan.com/jx0416/topics/1379548",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.dazhuanlan.com/jx0416/topics/1379548")]),_:1})]),e("p",null,[t("代码见 "),l(s,{href:"https://github.com/gesijiang/cutemines",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://github.com/gesijiang/cutemines")]),_:1})]),pe,de,_e,he,ue,me,ge,e("p",null,[l(s,{href:"https://yiwenzhe.com/2021/03/04/%E8%BD%AF%E4%BB%B6%E9%80%86%E5%90%91%E4%B9%8B%E6%89%AB%E9%9B%B7-%E4%BA%8C-%EF%BC%9A%E7%A0%B4%E8%A7%A3%E9%9B%B7%E5%8C%BA/",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://yiwenzhe.com/2021/03/04/软件逆向之扫雷-二-：破解雷区/")]),_:1})]),e("p",null,[l(s,{href:"https://bbs.pediy.com/user-home-939618.htm",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://bbs.pediy.com/user-home-939618.htm")]),_:1})]),e("p",null,[l(s,{href:"https://github.com/gesijiang/cutemines/blob/master/pojie.cpp",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://github.com/gesijiang/cutemines/blob/master/pojie.cpp")]),_:1})]),e("p",null,[l(s,{href:"https://www.freebuf.com/column/168450.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://www.freebuf.com/column/168450.html")]),_:1})]),e("p",null,[l(s,{href:"https://bbs.pediy.com/thread-144908.htm",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://bbs.pediy.com/thread-144908.htm")]),_:1})]),e("p",null,[l(s,{href:"https://blog.csdn.net/qq_43013814/article/details/109218514?spm=1001.2014.3001.5502",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://blog.csdn.net/qq_43013814/article/details/109218514?spm=1001.2014.3001.5502")]),_:1})]),e("p",null,[l(s,{href:"https://blog.csdn.net/double_piga/article/details/120782717",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://blog.csdn.net/double_piga/article/details/120782717")]),_:1})]),e("p",null,[l(s,{href:"https://github.com/repnz/ReversingMinesweeper",target:"_blank",rel:"noreferrer"},{default:n(()=>[t("https://github.com/repnz/ReversingMinesweeper")]),_:1})])]),"main-header":n(()=>[a(o.$slots,"main-header")]),"main-header-after":n(()=>[a(o.$slots,"main-header-after")]),"main-nav":n(()=>[a(o.$slots,"main-nav")]),"main-content":n(()=>[a(o.$slots,"main-content")]),"main-content-after":n(()=>[a(o.$slots,"main-content-after")]),"main-nav-before":n(()=>[a(o.$slots,"main-nav-before")]),"main-nav-after":n(()=>[a(o.$slots,"main-nav-after")]),comment:n(()=>[a(o.$slots,"comment")]),footer:n(()=>[a(o.$slots,"footer")]),aside:n(()=>[a(o.$slots,"aside")]),"aside-custom":n(()=>[a(o.$slots,"aside-custom")]),default:n(()=>[a(o.$slots,"default")]),_:3},8,["frontmatter","data"])}const Me=d(F,[["render",fe]]);export{Be as __pageData,Me as default};
