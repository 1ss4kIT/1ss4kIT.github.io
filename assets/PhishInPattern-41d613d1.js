import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as h,p as d,c as _,w as s,o as u,a as e,b as l,d as t,r as o,e as m}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const y="/images/pasted-378.png",Ve=JSON.parse('{"title":"钓鱼检测(二)PhishInPattern分析","description":"","frontmatter":{"layout":"post","title":"钓鱼检测(二)PhishInPattern分析","author":"1ss4k","tags":[],"categories":["恶意URL检测"],"date":"2022-11-21T11:27:00.000Z"},"headers":[{"level":2,"title":"文章阅读","slug":"文章阅读","link":"#文章阅读","children":[]},{"level":2,"title":"环境配置","slug":"环境配置","link":"#环境配置","children":[]},{"level":2,"title":"SeedCollector","slug":"seedcollector","link":"#seedcollector","children":[]},{"level":2,"title":"Crawler","slug":"crawler","link":"#crawler","children":[]},{"level":2,"title":"收获总结","slug":"收获总结","link":"#收获总结","children":[]}],"relativePath":"pages/posts/PhishInPattern.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/PhishInPattern.md","lastUpdated":1690730773000}'),r=JSON.parse('{"title":"钓鱼检测(二)PhishInPattern分析","description":"","frontmatter":{"layout":"post","title":"钓鱼检测(二)PhishInPattern分析","author":"1ss4k","tags":[],"categories":["恶意URL检测"],"date":"2022-11-21T11:27:00.000Z"},"headers":[{"level":2,"title":"文章阅读","slug":"文章阅读","link":"#文章阅读","children":[]},{"level":2,"title":"环境配置","slug":"环境配置","link":"#环境配置","children":[]},{"level":2,"title":"SeedCollector","slug":"seedcollector","link":"#seedcollector","children":[]},{"level":2,"title":"Crawler","slug":"crawler","link":"#crawler","children":[]},{"level":2,"title":"收获总结","slug":"收获总结","link":"#收获总结","children":[]}],"relativePath":"pages/posts/PhishInPattern.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/PhishInPattern.md","lastUpdated":1690730773000}'),g={name:"pages/posts/PhishInPattern.md",data(){return{data:r,frontmatter:r.frontmatter,$frontmatter:r.frontmatter}},setup(){d("pageData",r)}},A={id:"文章阅读",tabindex:"-1"},C=e("p",null,"1、文章等级：2022年IMC (CCF-B)",-1),f=e("p",null,"2、探索了超过5w个钓鱼网站，得出如下结论：",-1),w=e("ul",null,[e("li",null,"外观模仿某一目标，但不一定和目标一模一样"),e("li",null,"通常有多步操作"),e("li",null,"有验证步骤")],-1),k=e("p",null,"3、受害者提交完信息之后，网站反应如下：",-1),E=e("p",null,"钓鱼网站：",-1),b=e("ul",null,[e("li",null,[e("p",null,"重定向到错误页面")]),e("li",null,[e("p",null,"重定向到合法页面")]),e("li",null,[e("p",null,"输出success的信息，告诉用户他的数据仍是安全的")]),e("li",null,[e("p",null,"密码错误【分为有验证和无验证】")])],-1),D=e("p",null,"良性网站：",-1),v=e("ul",null,[e("li",null,"密码错误")],-1),B={id:"环境配置",tabindex:"-1"},P=e("p",null,[l("1、"),e("strong",null,"钓鱼URL来源：PhishTank")],-1),F=e("p",null,[l("原文使用的库是"),e("code",null,"OpenPhish"),l(" API，我尝试发邮件联系，对方未回复。故尝试使用Phishtank数据库。")],-1),I=e("p",null,[l("2、"),e("strong",null,"数据库使用：sqlalchemy")],-1),$=e("p",null,"**创建表：**运行phish_db_schema.py",-1),q=e("p",null,[e("strong",null,"3、sklearn")],-1),O=e("p",null,"出现如下错误",-1),S=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"No module named 'sklearn.linear_model.stochastic_gradient")])])])],-1),L=e("p",null,[l("尝试"),e("code",null," pip install scikit-learn --upgrade")],-1),N=e("p",null,"无法解决，随后在ubuntu系统上实验",-1),T=e("div",{class:"language-python"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install playwright")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install "),e("span",{style:{color:"#89DDFF"}},"-"),e("span",{style:{color:"#A6ACCD"}},"U scikit"),e("span",{style:{color:"#89DDFF"}},"-"),e("span",{style:{color:"#A6ACCD"}},"learn"),e("span",{style:{color:"#89DDFF"}},"=="),e("span",{style:{color:"#F78C6C"}},"0.21"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"3")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"mysql")])])])],-1),U=e("p",null,[e("strong",null,"❌ 4、交互软件：pypeteer")],-1),J=e("p",null,"原文使用 pypeteer，但遇到较多错误，后来也没人维护了，故使用更新的 playwright",-1),j=e("p",null,"仍然启动失败",-1),x=e("p",null,"太难用了...一直报错",-1),M=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},'File "/Users/my/opt/anaconda3/lib/python3.9/site-packages/pyppeteer/launcher.py", line 307, in launch')]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    return await Launcher(options, **kwargs).launch()")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},'  File "/Users/my/opt/anaconda3/lib/python3.9/site-packages/pyppeteer/launcher.py", line 168, in launch')]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    self.browserWSEndpoint = get_ws_endpoint(self.url)")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},'  File "/Users/my/opt/anaconda3/lib/python3.9/site-packages/pyppeteer/launcher.py", line 227, in get_ws_endpoint')]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    raise BrowserError('Browser closed unexpectedly:\\n')")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pyppeteer.errors.BrowserError: Browser closed unexpectedly:")])])])],-1),V=e("p",null,[l("这个项目现在也没人维护了，官方建议使用"),e("code",null,"Playwright-python"),l("。")],-1),R=e("p",null,[e("strong",null,"✅ 5、playwright-python")],-1),G=e("p",null,"pip安装后，只安装了playwright，但是没有下载chromium",-1),z=e("p",null,"输出命令 playwright install，即可下载浏览器。",-1),H=e("p",null,"Downloading Chromium 108.0.5359.29 (playwright build v1033)",-1),K=e("p",null,"代码中的 asyncio 表示异步操作。",-1),W={id:"seedcollector",tabindex:"-1"},Z=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip install mysqlclient #创建数据库")])])])],-1),Q=e("p",null,[l("1、"),e("code",null,"get_openphish_feeds.py"),l(" 从 "),e("code",null,"Open_Phish"),l("获取url，存储在AWS中。")],-1),Y=e("p",null,[l("2、"),e("code",null,"get_phishtank_valid_urls.py"),l(" 从 "),e("code",null,"PhishTank"),l(" 爬取验证过的url，存储在 "),e("code",null,"phish_db_layer"),l(" 结构中；从"),e("code",null,"OpenPhish"),l("爬取url，也存储在"),e("code",null,"phish_db_layer"),l("中。")],-1),X=e("p",null,[l("创建了表："),e("code",null,"Open_Phish_Links")],-1),ee=e("p",null,"3、得到alexa中网站合法的登陆url，一个网站可能对应多个url。",-1),le=e("p",null,"到database文件下，运行python3 phish_db_schema.py，就可以自动创建好所需要的表～",-1),se=e("p",null,"最开始运行的时候可能会有外键约束错误",-1),ne={id:"crawler",tabindex:"-1"},te=e("p",null,"0、依赖包下载",-1),ae=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip install pyenchant")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install pyppeteer")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install textblob")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install faker")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"pip3 install pyautogui #安装失败，先不管了")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"apt-get install chromium-chromedriver")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"安装google-chrome：https://www.cnblogs.com/myvic/p/10324531.html")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"brew install enchant brew更新时间很长")])])])],-1),oe=e("p",null,"输入参数",-1),re=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"url")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"--phish_id")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"--timeout")])])])],-1),ie=e("p",null,[l("定义了 "),e("code",null,"crawl_web_page"),l("函数，其处理流程如下：")],-1),pe=e("p",null,[l("1、使用"),e("code",null,"pyppeteer"),l("设置"),e("code",null,"browser.newPage")],-1),ce=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"temp = None ")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"samePage = 0")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"count=phish_id")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"page_count = 0")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"res_page_count = 0")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"page_requests = []")]),l(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"page_responses = []")])])])],-1),he=e("p",null,"定义如下函数： （1）handle_request",-1),de=e("p",null,[l("存储请求，对于重定向"),e("code",null,"redirectChain"),l("的url，迭代递归处理")],-1),_e=e("p",null,"（2）handle_response",-1),ue=e("p",null,"存储页面内容",-1),me=e("p",null,"❌（3）evaluateOnNewDocument",-1),ye=e("p",null,"换成 evaluateHandle，仍然不行，需要找到一个合适的函数。",-1),ge=e("p",null,"extra_scripts.js_add_event_override",-1),Ae=e("p",null,"（4）log_events_helper",-1),Ce=e("p",null,"记录[CONSOLE LOG]",-1),fe=e("p",null,"2、访问页面",-1),we=e("p",null,"需要修改一些函数的名称，参考官方文档即可，两者命名有很大的相似性。",-1),ke=e("p",null,"JJ 换为 query_selector_all",-1),Ee=e("p",null,"J 换为 query_selector",-1),be=e("p",null,"JJeval 换为 eval_on_selector_all",-1),De=e("p",null,"Jeval 换为 eval_on_selector",-1),ve=e("p",null,"isIntersectingViewport 直接删掉，我还需要处理不可见的内容",-1),Be={id:"收获总结",tabindex:"-1"},Pe=e("p",null,"1、这篇文章对我有很大的鼓舞，证明了这种交互的方法是可行的，并且开源了一个交互的代码框架！近期各种文章似乎都在朝这个方向发展，像是冰面下涌动的河流。我也一定要抓紧时间赶快做实验，赶上时代的列车。",-1),Fe=e("p",null,"作者似乎本意是想做钓鱼网站检测的，但是从交互到钓鱼网站检测仍有很多难题需要突破，故文章第二部分就进行了统计性分析。",-1),Ie=e("p",null,"2、如果网站做了防护，真实的用户可以访问到，而爬虫不会访问到，一直停留在",-1),$e=e("p",null,[e("img",{src:y,alt:"upload successful"})],-1),qe=e("p",null,"3、截至2023年1月4日，代码复现基本完成，但在实际场景中效果较差，目前暂不清楚应该收集哪些数据，使用什么样的模型。下一步计划阅读其他论文找寻灵感。",-1);function Oe(a,Se,Le,Ne,i,Te){const n=m,p=c;return u(),_(p,{frontmatter:i.frontmatter,data:i.data},{"main-content-md":s(()=>[e("h2",A,[l("文章阅读 "),t(n,{class:"header-anchor",href:"#文章阅读","aria-hidden":"true"},{default:s(()=>[l("#")]),_:1})]),C,f,w,k,E,b,D,v,e("h2",B,[l("环境配置 "),t(n,{class:"header-anchor",href:"#环境配置","aria-hidden":"true"},{default:s(()=>[l("#")]),_:1})]),P,F,I,e("p",null,[l("Mysql安装5.0版本 "),t(n,{href:"https://juejin.cn/post/6903070115823419399",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("教程")]),_:1})]),e("p",null,[l("mysql "),t(n,{href:"https://www.jianshu.com/p/1f0c8e3c438b#:~:text=%E8%A7%A3%E5%86%B3Django%E6%89%A7%E8%A1%8Cmanage.py%20%E6%8F%90%E7%A4%BA%20NameError%3A%20name%20%27_mysql%27%20is%20not%20defined,%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A%20%E4%BD%BF%E7%94%A8pymysql%E4%BB%A3%E6%9B%BFMySQLdb%20%E6%AD%A5%E9%AA%A4%EF%BC%9A%20%E5%AE%89%E8%A3%85pymysql%EF%BC%9Apip%20install%20pymysql%20%E6%89%93%E5%BC%80%E9%A1%B9%E7%9B%AE%E5%9C%A8setting.py%E7%9A%84%20init.py%2C%E6%88%96%E7%9B%B4%E6%8E%A5%E5%9C%A8%E5%BD%93%E5%89%8Dpy%E6%96%87%E4%BB%B6%E6%9C%80%E5%BC%80%E5%A4%B4%E6%B7%BB%E5%8A%A0%E5%A6%82%E4%B8%8B%EF%BC%9A",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("报错解决")]),_:1})]),$,q,O,S,L,N,T,U,J,e("p",null,[l("pypeteer Chromium "),t(n,{href:"https://blog.51cto.com/u_15127666/4157760",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("安装教程")]),_:1}),t(n,{href:"https://mirrors.huaweicloud.com/chromium-browser-snapshots/Mac/588429/",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("下载地址")]),_:1})]),j,e("p",null,[t(n,{href:"https://blog.csdn.net/lovechris00/article/details/81561627",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("查看动态链接库是否有安装失败")]),_:1}),l("，无果")]),x,M,V,R,e("p",null,[t(n,{href:"https://github.com/microsoft/playwright-python",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("项目地址")]),_:1})]),G,z,H,K,e("h2",W,[l("SeedCollector "),t(n,{class:"header-anchor",href:"#seedcollector","aria-hidden":"true"},{default:s(()=>[l("#")]),_:1})]),Z,Q,Y,X,ee,le,se,e("p",null,[l("参考"),t(n,{href:"https://stackoverflow.com/questions/21659691/error-1452-cannot-add-or-update-a-child-row-a-foreign-key-constraint-fails",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("这篇文章")]),_:1}),l("， 设置：SET GLOBAL FOREIGN_KEY_CHECKS=0;")]),e("h2",ne,[l("Crawler "),t(n,{class:"header-anchor",href:"#crawler","aria-hidden":"true"},{default:s(()=>[l("#")]),_:1})]),te,ae,oe,re,ie,pe,ce,he,de,_e,ue,me,ye,ge,Ae,Ce,fe,we,e("p",null,[l("continue_ 修改 "),t(n,{href:"https://dev.to/checkly/request-interception-with-puppeteer-and-playwright-1503",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("参考教程 ")]),_:1})]),ke,Ee,be,De,e("p",null,[t(n,{href:"https://www.lambdatest.com/automation-testing-advisor/python/playwright-python-eval_on_selector_all",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("参考：")]),_:1})]),ve,e("h2",Be,[l("收获总结 "),t(n,{class:"header-anchor",href:"#收获总结","aria-hidden":"true"},{default:s(()=>[l("#")]),_:1})]),Pe,Fe,Ie,e("p",null,[t(n,{href:"https://www-bitkub-login.com/?camp=jozao",target:"_blank",rel:"noreferrer"},{default:s(()=>[l("https://www-bitkub-login.com/?camp=jozao")]),_:1})]),$e,qe]),"main-header":s(()=>[o(a.$slots,"main-header")]),"main-header-after":s(()=>[o(a.$slots,"main-header-after")]),"main-nav":s(()=>[o(a.$slots,"main-nav")]),"main-content":s(()=>[o(a.$slots,"main-content")]),"main-content-after":s(()=>[o(a.$slots,"main-content-after")]),"main-nav-before":s(()=>[o(a.$slots,"main-nav-before")]),"main-nav-after":s(()=>[o(a.$slots,"main-nav-after")]),comment:s(()=>[o(a.$slots,"comment")]),footer:s(()=>[o(a.$slots,"footer")]),aside:s(()=>[o(a.$slots,"aside")]),"aside-custom":s(()=>[o(a.$slots,"aside-custom")]),default:s(()=>[o(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const Re=h(g,[["render",Oe]]);export{Ve as __pageData,Re as default};
