import{_}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as h,p as c,c as u,w as s,o as p,a as e,b as t,d as a,r as o,e as f}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const T="/images/pasted-333.png",m="/images/pasted-334.png",P="/images/pasted-335.png",Ze=JSON.parse('{"title":"使用URL相关性分析的基于HTTP的APT恶意软件检测","description":"","frontmatter":{"layout":"post","title":"使用URL相关性分析的基于HTTP的APT恶意软件检测","tags":[],"categories":["paper阅读笔记"],"author":"1ss4k","date":"2021-04-18T10:06:00.000Z"},"headers":[{"level":2,"title":"1.背景","slug":"_1-背景","link":"#_1-背景","children":[]},{"level":2,"title":"论文主要方法","slug":"论文主要方法","link":"#论文主要方法","children":[]},{"level":2,"title":"总体流程","slug":"总体流程","link":"#总体流程","children":[]},{"level":2,"title":"实验","slug":"实验","link":"#实验","children":[]},{"level":2,"title":"个人总结和研究启发","slug":"个人总结和研究启发","link":"#个人总结和研究启发","children":[]}],"relativePath":"pages/posts/URL APT attack HTTP.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/URL APT attack HTTP.md","lastUpdated":1690730773000}'),i=JSON.parse('{"title":"使用URL相关性分析的基于HTTP的APT恶意软件检测","description":"","frontmatter":{"layout":"post","title":"使用URL相关性分析的基于HTTP的APT恶意软件检测","tags":[],"categories":["paper阅读笔记"],"author":"1ss4k","date":"2021-04-18T10:06:00.000Z"},"headers":[{"level":2,"title":"1.背景","slug":"_1-背景","link":"#_1-背景","children":[]},{"level":2,"title":"论文主要方法","slug":"论文主要方法","link":"#论文主要方法","children":[]},{"level":2,"title":"总体流程","slug":"总体流程","link":"#总体流程","children":[]},{"level":2,"title":"实验","slug":"实验","link":"#实验","children":[]},{"level":2,"title":"个人总结和研究启发","slug":"个人总结和研究启发","link":"#个人总结和研究启发","children":[]}],"relativePath":"pages/posts/URL APT attack HTTP.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/URL APT attack HTTP.md","lastUpdated":1690730773000}'),b={name:"pages/posts/URL APT attack HTTP.md",data(){return{data:i,frontmatter:i.frontmatter,$frontmatter:i.frontmatter}},setup(){c("pageData",i)}},g={id:"_1-背景",tabindex:"-1"},H={id:"_1-刊物-会议级别",tabindex:"-1"},L={id:"_2-作者团队",tabindex:"-1"},k=e("p",null,"作者来自电子科技大学网络安全研究所、鹏城实验室、中国工程物理研究院(绵阳)。",-1),w={id:"_3-论文背景",tabindex:"-1"},R=e("p",null,"本文使用HTTP header中的referer field去构建一个web请求图。通过URL相似性和重定向重建去优化构建的图。用不相关请求过滤去过滤掉剩余的不相关的合法请求。",-1),U=e("p",null,"主要贡献如下：",-1),v=e("p",null,"1.本文提出了一种基于图理论的方法去检测基于HTTP的APT恶意软件。",-1),A=e("p",null,"2.小部分正常请求不包含referer field，用两种方法：重定向重构和URL相似性，去加入缺失的用户正常请求，以优化请求图。",-1),$=e("p",null,"3.使用Local Outlier Factor去构建过滤器，它可以过滤掉83.2%的正常不相关的请求。",-1),x=e("p",null,"由于缺乏大规模的有标签的APT恶意数据集，本文没有使用机器学习的方法，而是使用基于相关性的方法。",-1),I={id:"论文主要方法",tabindex:"-1"},B=e("p",null,"本文使用到的方法主要有：",-1),S=e("p",null,"(1) HTTP请求图",-1),y=e("p",null,"(2) HTTP请求分类",-1),C={id:"_1-http请求图",tabindex:"-1"},M=e("p",null,"​ 当浏览器发送HTTP请求去请求资源的时候，会请求HTML代码，然后再基于这个HTML代码去加载相应资源。在请求后续资源的时候，可能会再请求下载其他资源，这就需要更多的HTTP请求去完成。所以：可以使用web请求图去表示请求关系。",-1),N=e("p",null,"​ 许多恶意的HTTP请求会加入很多用户合法的HTTP请求去隐藏自己，但是我们发现，基于HTTP的APT恶意软件的初始化HTTP请求不包含Referer fields，并且它与用户的浏览行为不相关。所以构建出图之后，恶意URL请求会变成孤立的点。",-1),V={id:"_2-http请求分类",tabindex:"-1"},F=e("p",null,"需要对HTTP请求进行分类和过滤。本文根据HTTP产生的方式把其分为4类：",-1),O=e("p",null,"(1) 用户初始化请求。此时refer field通常为空。",-1),J=e("p",null,"(2) 包含webpage的请求。又浏览器产生的，不是由用户直接产生的。Refer field是源URL。",-1),D=e("p",null,"(3) 正常的非相关请求。用户的良性web请求，但是缺乏refer field。虽然没有refer field，不能被直接加入到图中，但是与用户正常浏览有关。",-1),G=e("p",null,"(4) 恶意请求。包含不相关的HTTP请求。",-1),Z={id:"总体流程",tabindex:"-1"},q=e("p",null,"​ 本文提出了一种使用基于URL相关性的web请求图去检测APT恶意攻击的方法，主要包括四个过程：(1)预处理；(2)构建一个web请求图; (3)优化web请求图；(4)正常不相关请求过滤。",-1),j={id:"_1-预处理",tabindex:"-1"},z=e("p",null,"​ 用mitproxy去获取HTTP流量，并按照users的IP进行分类。然后提取referer field，host field和request URL field。用相应的URL构建web请求图。",-1),E=e("p",null,"​ 用HTTP响应请求来优化构建的图。",-1),K={id:"_2-构建web请求图",tabindex:"-1"},Q=e("p",null,"​ 根据不同的IP，构建各自IP的数据图。通常用户初始化请求是web图的初始节点。",-1),W={id:"_3-优化web请求图",tabindex:"-1"},X=e("p",null,"​ 有些良性请求没有referer field，本文将这些正常的非相关的请求也加入到图中。关于怎么加入：本文提出了两种方法，分别是:（1）重定向重构（2）URL相似性。",-1),Y=e("p",null,"(1)重定向重构",-1),ee=e("p",null,"如果用户的初始化请求是重定向，响应的location field会给出重定向地址。浏览器会自动跳转到重定向地址，然后发送HTTP请求。但是，重定向之后的包的referer field是空的，所以之后的请求和初始的这个重定向请求是不相关的。",-1),te=e("p",null,"​ *根据响应头的状态码，来确实是否是重定向。301、302、303、307是重定向。",-1),se=e("p",null,"​ *对于基于HTML和基于JavaScript的重定向，重放HTTP请求包，然后检查meta元素和window.location属性，去判断这个页面是否是重定向的。",-1),ne=e("p",null,"如果是重定向的，修改响应的边的关系。",-1),ae=e("p",null,"(2)URL相似性",-1),le=e("p",null,"就算使用了重定向重构，还是有一些节点是孤立的。",-1),oe=e("p",null,"作者又发现不相关的URL请求与正常的URL请求之间有一定的相似性。关注的是word-level级的相似性。用公式去计算两个URL之间的相似性。",-1),ie=e("p",null,"​ 公式的计算方法为：相同元素的个数/A或B元素个数的最大值。是把要去计算的不相关节点和图中所有节点的相似性，然后找出最大的值。如果最大的值>阈值，那么就认为是相关的，把相应的URL加入图中，它和这个最相似的节点地位相同。",-1),re={id:"_4-过滤正常的不相关请求",tabindex:"-1"},de=e("p",null,"​ 通常是一些其他应用产生的HTTP请求。",-1),_e=e("p",null,"​ 本文使用机器学习的方法 去构建一个正常请求filter，去过滤掉那些正常请求。",-1),he=e("p",null,[e("img",{src:T,alt:"upload successful"})],-1),ce=e("p",null,"提取到的特征如上图。",-1),ue=e("p",null,"本文只用良性数据去训练，过滤掉时候也只会过滤掉良性的数据。",-1),pe={id:"实验",tabindex:"-1"},fe={id:"_1-数据集",tabindex:"-1"},Te=e("p",null,"​ 良性：使用的数据集来自clickminer，数据集总量是1.48GB，有超过70,000个HTTP请求。使用1GB的流量去训练机器学习的正常非相关请求过滤器，剩下的用来评估。",-1),me={id:"_2-参数选取",tabindex:"-1"},Pe=e("p",null,"​ 先选取合适的机器学习算法：One Class SVM, Isolation Forest, Local outlier Factor. 用来训练的数据是：良性数据构造完图之后孤立的节点。结果如下：",-1),be=e("p",null,[e("img",{src:m,alt:"upload successful"})],-1),ge=e("p",null,"此时Local outlier Factor设定的n_neighbors=7. 性能最好～",-1),He={id:"_3-实验结果分析",tabindex:"-1"},Le=e("p",null,"1.URL相似度：",-1),ke=e("p",null,"设定阈值v= 0.5，",-1),we=e("p",null,"2.优化图",-1),Re=e("p",null,"发现准确度提高了很多，但是恶意请求只减少了1.84%，原因是：一小部分恶意请求在图优化的过程中被加入了图中，因为URL的相似性。主要是因为：恶意数据集也包含着一些合法的流量，但是这些合法流量却被认为是恶意的。",-1),Ue=e("p",null,"3.对比比较",-1),ve=e("p",null,[e("img",{src:P,alt:"upload successful"})],-1),Ae=e("p",null,"由上图可知，本文提出的方法在各个方面都有比较好的性能。",-1),$e=e("p",null,"4.本文方法的局限性",-1),xe=e("p",null,"本文主要参考的是referer field，如果恶意软件伪造了referer field为已知的良性节点，我们的方法就不能正确识别出来了。",-1),Ie=e("p",null,"本文的方法还能用于botnets检测，当botnet使用HTTP、C&C的时候，就和恶意软件一样了。但是本文不能检测网络隐蔽信道。",-1),Be={id:"个人总结和研究启发",tabindex:"-1"},Se=e("ol",null,[e("li",null,[e("p",null,"本文提出了一种混的方法，先构建出web请求图，然后进行优化，再用机器学习的方法过滤掉一些数据。")]),e("li",null,[e("p",null,"本文比较重要的地方在于：把非相关的请求也加入了图中。用到的方法是重定向和URL的相似性。")]),e("li",null,[e("p",null,"URL相似性在比较的时候，用单个节点与图中的所有节点进行比较，如果相似度>阈值0.5，就认为是合法的良性请求，加入图中。但是这种方法在图中节点的数量比较多的时候，时间复杂度会比较高。而且阈值的设定应该再多实验几次，相似度的计算方法可以改进。")])],-1);function ye(l,Ce,Me,Ne,r,Ve){const n=f,d=_;return p(),u(d,{frontmatter:r.frontmatter,data:r.data},{"main-content-md":s(()=>[e("h2",g,[t("1.背景 "),a(n,{class:"header-anchor",href:"#_1-背景","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),e("h5",H,[t("1.刊物/会议级别 "),a(n,{class:"header-anchor",href:"#_1-刊物-会议级别","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),e("p",null,[t("2021年发表于Hindawi，是一个开源期刊，属于SCI 4区。2021年1月，wiley收购hindawi (见"),a(n,{href:"http://news.sciencenet.cn/htmlpaper/2021/1/2021161455023960628.shtm",target:"_blank",rel:"noreferrer"},{default:s(()=>[t("http://news.sciencenet.cn/htmlpaper/2021/1/2021161455023960628.shtm")]),_:1}),t(")。")]),e("h5",L,[t("2.作者团队 "),a(n,{class:"header-anchor",href:"#_2-作者团队","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),k,e("h5",w,[t("3.论文背景 "),a(n,{class:"header-anchor",href:"#_3-论文背景","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),R,U,v,A,$,x,e("h2",I,[t("论文主要方法 "),a(n,{class:"header-anchor",href:"#论文主要方法","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),B,S,y,e("h5",C,[t("1.HTTP请求图 "),a(n,{class:"header-anchor",href:"#_1-http请求图","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),M,N,e("h5",V,[t("2.HTTP请求分类 "),a(n,{class:"header-anchor",href:"#_2-http请求分类","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),F,O,J,D,G,e("h2",Z,[t("总体流程 "),a(n,{class:"header-anchor",href:"#总体流程","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),q,e("h5",j,[t("1.预处理 "),a(n,{class:"header-anchor",href:"#_1-预处理","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),z,E,e("h5",K,[t("2.构建web请求图 "),a(n,{class:"header-anchor",href:"#_2-构建web请求图","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),Q,e("h5",W,[t("3.优化web请求图 "),a(n,{class:"header-anchor",href:"#_3-优化web请求图","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),X,Y,ee,te,se,ne,ae,le,oe,ie,e("h5",re,[t("4.过滤正常的不相关请求 "),a(n,{class:"header-anchor",href:"#_4-过滤正常的不相关请求","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),de,_e,he,ce,ue,e("h2",pe,[t("实验 "),a(n,{class:"header-anchor",href:"#实验","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),e("h5",fe,[t("1.数据集 "),a(n,{class:"header-anchor",href:"#_1-数据集","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),Te,e("p",null,[t("​ 恶意APT攻击：数据来自"),a(n,{href:"https://www.stratosphereips.org",target:"_blank",rel:"noreferrer"},{default:s(()=>[t("Stratosphere Lab")]),_:1}),t("，"),a(n,{href:"http://contagiodump.blogspot.com",target:"_blank",rel:"noreferrer"},{default:s(()=>[t("Contagiodump")]),_:1}),t(", "),a(n,{href:"./目前不可访问"},{default:s(()=>[t("Pcapanalysis")]),_:1}),t("。总量是280MB，有超过10,000个HTTP请求。")]),e("h5",me,[t("2.参数选取 "),a(n,{class:"header-anchor",href:"#_2-参数选取","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),Pe,be,ge,e("h5",He,[t("3.实验结果分析 "),a(n,{class:"header-anchor",href:"#_3-实验结果分析","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),Le,ke,we,Re,Ue,ve,Ae,$e,xe,Ie,e("h2",Be,[t("个人总结和研究启发 "),a(n,{class:"header-anchor",href:"#个人总结和研究启发","aria-hidden":"true"},{default:s(()=>[t("#")]),_:1})]),Se]),"main-header":s(()=>[o(l.$slots,"main-header")]),"main-header-after":s(()=>[o(l.$slots,"main-header-after")]),"main-nav":s(()=>[o(l.$slots,"main-nav")]),"main-content":s(()=>[o(l.$slots,"main-content")]),"main-content-after":s(()=>[o(l.$slots,"main-content-after")]),"main-nav-before":s(()=>[o(l.$slots,"main-nav-before")]),"main-nav-after":s(()=>[o(l.$slots,"main-nav-after")]),comment:s(()=>[o(l.$slots,"comment")]),footer:s(()=>[o(l.$slots,"footer")]),aside:s(()=>[o(l.$slots,"aside")]),"aside-custom":s(()=>[o(l.$slots,"aside-custom")]),default:s(()=>[o(l.$slots,"default")]),_:3},8,["frontmatter","data"])}const qe=h(b,[["render",ye]]);export{Ze as __pageData,qe as default};
