---
layout: post
title: 恶意URL检测(三)深度学习
tags:
  - 恶意URL检测
categories:
  - 恶意URL检测
author: 1ss4k
date: 2021-01-25 12:11:00
---
此文是关于两篇文章的总结



## 一



第一篇：https://www.fireeye.com/blog/threat-research/2021/01/training-transformers-for-cyber-security-tasks-malicious-url-prediction.html



1、关于本文用到的Transformer模型，前置知识参考 https://zhuanlan.zhihu.com/p/82312421

它支持自监督，可以使用没有标记的数据。本文使用它作为特征提取器。

2、每个URL与一个token相关。

3、此模型训练好之后，可以用来预测下一个最有可能出现的字符，也可以用来预测某个url是恶意的概率。

4、本文使用FFNN作为分类器。

5、本文的方法同时考虑到了预测阶段本条与下一条的特征。

![upload successful](/images/pasted-180.png)

亮点：

1、使用Transformer模型

2、与深度学习模型的结果进行了比较

3、把url检测与nlp联系起来

4、介绍了一个新的损失函数



## 二



题目：Malicious URL Detection using Deep Learning



1、以往检测方法：

黑名单、正则表达式和签名匹配等方法。但是不能发现未出现过的url。

最近，最常用的方法是应用领域知识提取URL的词汇特征，然后应用机器学习模型。

但是，机器学习也面临很多困难(详见文中)。



2、机器学习方法的发展

* 传统的方法基于特征提取。但是有较多缺点。

* 逐渐开始使用 字符级嵌入，以及一些机器学习、深度学习的方法



3、一个模型可能可以去解决很多个安全方面的问题。



4、深度学习模型

* 混合体系结构(CNN+LSTM)
* 基于字符的模型



5、字符级嵌入

使用 字符级嵌 入对原始url进行编码。字符级嵌入是自然语言处理（NLP）中一种 以数字格式表示字符的先进方法。



6、问题描述：

我们需要：1)找到最优的特征表示 2)预测函数



7、恶意URL检测的困难性

(1)数据集 (2)基于时间来分割训练集和测试集



8、实验细节

在DUD中，字符级keras嵌入让128作为嵌入大小，因为每个字符映射到128维。这有助于 通过将相似字符的语义映射到相似向量 来学习字符之间的相似性。



损失函数如下：

![upload successful](/images/pasted-181.png)

Pd是测试数据集中所有样本的预测概率向量，ed是期望类标签的向量，值为0或1


本文提出的体系结构如下：

![upload successful](/images/pasted-182.png)

9、实验结果分析

* 数据集1的训练结果比数据集2要好。
* 数据集2上，随机分割比基于时间分割效果更好。这与我们的预期相反。这是因为数据集2的时间分割的测试样本 在训练期间是不可见的。

* 所有模型的性能 在准确性和AUC方面都有细微差别，因此可以采用投票方法来区分URL是合法的还是恶意的。



收获：

1、可以使用多个模型，最后采取投票的方法来判定是否是恶意URL。

2、使用基于字符级K

3、使用常规方法作为初始的一关，再使用深度学习方法，效果比较好。

4、通过添加诸如注册服务、网站内容、网络信誉、文件路径和注册表项等辅助模块，可以使本文的DeepURLDetect（DUD）模型更加健壮。